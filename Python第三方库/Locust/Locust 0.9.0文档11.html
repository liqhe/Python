<!DOCTYPE html>
<!-- saved from url=(0054)https://docs.locust.io/en/stable/extending-locust.html -->
<html class="js flexbox canvas canvastext webgl no-touch geolocation postmessage websqldatabase indexeddb hashchange history draganddrop websockets rgba hsla multiplebgs backgroundsize borderimage borderradius boxshadow textshadow opacity cssanimations csscolumns cssgradients cssreflections csstransforms csstransforms3d csstransitions fontface generatedcontent video audio localstorage sessionstorage webworkers applicationcache svg inlinesvg smil svgclippaths translated-ltr" lang="zh-CN" style=""><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>扩展蝗虫 - 蝗虫0.9.0文档</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="./Locust 0.9.0文档11_files/theme.css" type="text/css">
  <link rel="stylesheet" href="./Locust 0.9.0文档11_files/pygments.css" type="text/css">
    <link rel="index" title="指数" href="https://docs.locust.io/en/stable/genindex.html">
    <link rel="search" title="搜索" href="https://docs.locust.io/en/stable/search.html">
    <link rel="next" title="第三方工具" href="https://docs.locust.io/en/stable/third-party-tools.html">
    <link rel="prev" title="API" href="https://docs.locust.io/en/stable/api.html"> 

  
  <script async="" src="./Locust 0.9.0文档11_files/analytics.js"></script><script src="./Locust 0.9.0文档11_files/modernizr.min.js"></script>


<!-- RTD Extra Head -->

<!-- 
Always link to the latest version, as canonical.
http://docs.readthedocs.org/en/latest/canonical.html
-->
<link rel="canonical" href="http://docs.locust.io/en/stable/extending-locust.html">

<link rel="stylesheet" href="./Locust 0.9.0文档11_files/readthedocs-doc-embed.css" type="text/css">

<script type="text/javascript" src="./Locust 0.9.0文档11_files/readthedocs-data.js"></script>

<!-- Add page-specific data, which must exist in the page js, not global -->
<script type="text/javascript">
READTHEDOCS_DATA['page'] = 'extending-locust'
READTHEDOCS_DATA['source_suffix'] = '.rst'
</script>

<script type="text/javascript" src="./Locust 0.9.0文档11_files/readthedocs-analytics.js"></script>

<!-- end RTD <extrahead> -->
<link type="text/css" rel="stylesheet" charset="UTF-8" href="./Locust 0.9.0文档11_files/translateelement.css"></head>

<body class="wy-body-for-nav" style="">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="https://docs.locust.io/en/stable/index.html" class="icon icon-home"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 刺槐
          

          
          </font></font></a>

          
            
            
            
              <div class="version"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                稳定
              </font></font></div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="https://docs.locust.io/en/stable/search.html" method="get">
    <input type="text" name="q" placeholder="Search docs">
    <input type="hidden" name="check_keywords" value="yes">
    <input type="hidden" name="area" value="default">
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="https://docs.locust.io/en/stable/what-is-locust.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">什么是蝗虫？</font></font></a></li>
<li class="toctree-l1"><a class="reference internal" href="https://docs.locust.io/en/stable/installation.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安装</font></font></a></li>
<li class="toctree-l1"><a class="reference internal" href="https://docs.locust.io/en/stable/quickstart.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">快速开始</font></font></a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="https://docs.locust.io/en/stable/writing-a-locustfile.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">编写一个locustfile</font></font></a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="https://docs.locust.io/en/stable/running-locust-distributed.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">运行Locust分布式</font></font></a></li>
<li class="toctree-l1"><a class="reference internal" href="https://docs.locust.io/en/stable/running-locust-without-web-ui.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在没有Web UI的情况下运行Locust</font></font></a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="https://docs.locust.io/en/stable/retrieving-stats.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以CSV格式检索测试统计信息</font></font></a></li>
<li class="toctree-l1"><a class="reference internal" href="https://docs.locust.io/en/stable/testing-other-systems.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用自定义客户端测试其他系统</font></font></a></li>
<li class="toctree-l1"><a class="reference internal" href="https://docs.locust.io/en/stable/api.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API</font></font></a></li>
<li class="toctree-l1 current"><a class="reference internal current" href="https://docs.locust.io/en/stable/extending-locust.html#"><span class="toctree-expand"></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">扩大蝗虫</font></font></a><ul>
<li class="toctree-l2"><a class="reference internal" href="https://docs.locust.io/en/stable/extending-locust.html#adding-web-routes"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">添加Web路由</font></font></a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="https://docs.locust.io/en/stable/third-party-tools.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第三方工具</font></font></a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="https://docs.locust.io/en/stable/changelog.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">变更日志亮点</font></font></a></li>
</ul>

            
          
        </div>
      <div id="rtd-pk213nj5" class="ethical-rtd ethical-dark-theme"><div class="ethical-sidebar"><div class="ethical-content"><a href="https://readthedocs.org/sustainability/click/305/kfB7HXdvzpBp/" rel="nofollow" target="_blank" class="ethical-image-link"><img src="./Locust 0.9.0文档11_files/readthedocs-logo-fs8.png"></a><div class="ethical-text"><a href="https://readthedocs.org/sustainability/click/305/kfB7HXdvzpBp/" rel="nofollow" target="_blank"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">私人回购和优先支持</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">尝试阅读今日商业文档！</font></font></a></div></div><div class="ethical-callout"><small><em><a href="https://readthedocs.org/sustainability/advertising/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">赞助商</font></font></a><span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">· </font></font></span><a href="https://docs.readthedocs.io/en/latest/ethical-advertising.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">道德服务广告</font></font></a></em></small></div></div><img src="./Locust 0.9.0文档11_files/saved_resource" style="display: none;"></div></div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="https://docs.locust.io/en/stable/index.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">刺槐</font></font></a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="https://docs.locust.io/en/stable/index.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文件</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> »</font></font></li>
        
      <li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">扩大蝗虫</font></font></li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/locustio/locust/blob/4bde2ca90f28bde649ff4ce2c86e36a6e6260856/docs/extending-locust.rst" class="fa fa-github"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 在GitHub上编辑</font></font></a>
            
          
        
      </li>
    
  </ul>

  
  <hr>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="extending-locust">
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">扩展蝗虫</font></font><a class="headerlink" href="https://docs.locust.io/en/stable/extending-locust.html#extending-locust" title="永久链接到这个标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h1>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">蝗虫附带了许多事件，为不同方式扩展蝗虫提供了钩子。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以在模块级别在蝗虫文件中注册事件侦听器。</font><font style="vertical-align: inherit;">这是一个例子：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">locust</span> <span class="k">import</span> <span class="n">events</span>

<span class="k">def</span> <span class="nf">my_success_handler</span><span class="p">(</span><span class="n">request_type</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">response_time</span><span class="p">,</span> <span class="n">response_length</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="nb">print</span> <span class="s2">"Successfully fetched: </span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">)</span>

<span class="n">events</span><span class="o">.</span><span class="n">request_success</span> <span class="o">+=</span> <span class="n">my_success_handler</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注意</font></font></p>
<p class="last"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">强烈建议您在侦听器中添加一个通配符关键字参数（上面代码中的** kw），以防止在未来版本中添加新参数时代码中断。</font></font></p>
</div>
<div class="admonition seealso">
<p class="first admonition-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">也可以看看</font></font></p>
<p class="last"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要查看所有可用事件，请参阅</font></font><a class="reference internal" href="https://docs.locust.io/en/stable/api.html#events"><span class="std std-ref"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">事件挂钩</font></font></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="section" id="adding-web-routes">
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">添加Web路由</font></font><a class="headerlink" href="https://docs.locust.io/en/stable/extending-locust.html#adding-web-routes" title="永久链接到这个标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h2>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Locust使用Flask来提供Web UI，因此很容易将Web端点添加到Web UI。</font><font style="vertical-align: inherit;">只需在locustfile中导入Flask应用程序并设置新路径：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">locust</span> <span class="k">import</span> <span class="n">web</span>

<span class="nd">@web</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">"/added_page"</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">my_added_page</span><span class="p">():</span>
    <span class="k">return</span> <span class="s2">"Another page"</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您现在应该能够启动蝗虫并浏览到</font></font><a class="reference external" href="http://127.0.0.1:8089/added_page"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://127.0.0.1:8089/added_pa​​ge</font></font></a></p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="https://docs.locust.io/en/stable/third-party-tools.html" class="btn btn-neutral float-right" title="第三方工具" accesskey="n" rel="next"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">下一个 </font></font><span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="https://docs.locust.io/en/stable/api.html" class="btn btn-neutral" title="API" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 以前</font></font></a>
      
    </div>
  

  <hr><div><div id="rtd-3csuymd3" class="ethical-rtd"></div></div>

  <div role="contentinfo">
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        ©版权所有。
      
        </font></font><span class="commit"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          修订</font></font><code>4bde2ca9</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></span>
      

    </p>
  </div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font><a href="https://readthedocs.org/"><font style="vertical-align: inherit;">Read the Docs</font></a><font style="vertical-align: inherit;">提供</font><font style="vertical-align: inherit;">的</font><a href="https://github.com/rtfd/sphinx_rtd_theme"><font style="vertical-align: inherit;">主题</font></a><font style="vertical-align: inherit;"> 
  使用</font></font><a href="http://sphinx-doc.org/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sphinx</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">构建</font><font style="vertical-align: inherit;">。 

</font></font><a href="https://github.com/rtfd/sphinx_rtd_theme"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><a href="https://readthedocs.org/"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font></footer>

        </div>
      </div>

    </section>

  </div>
  

  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">阅读文档</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
      v：stable
      </font></font><span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions"><!-- Inserted RTD Footer -->
<div class="injected">

  

      
      
      
      <dl>
        <dt>Versions</dt>
        
        
        <dd><a href="http://docs.locust.io/en/latest/extending-locust.html">latest</a></dd>
        
        
         <strong> 
        <dd><a href="http://docs.locust.io/en/stable/extending-locust.html">stable</a></dd>
         </strong> 
        
        
        <dd><a href="http://docs.locust.io/en/0.9.0/extending-locust.html">0.9.0</a></dd>
        
        
        
        <dd><a href="http://docs.locust.io/en/v0.8.1/extending-locust.html">v0.8.1</a></dd>
        
        
        
        <dd><a href="http://docs.locust.io/en/v0.8/extending-locust.html">v0.8</a></dd>
        
        
        
        <dd><a href="http://docs.locust.io/en/v0.7.5/extending-locust.html">v0.7.5</a></dd>
        
        
        
        <dd><a href="http://docs.locust.io/en/v0.7.2/extending-locust.html">v0.7.2</a></dd>
        
        
        
        <dd><a href="http://docs.locust.io/en/v0.7.1/extending-locust.html">v0.7.1</a></dd>
        
        
        
        <dd><a href="http://docs.locust.io/en/v0.7/extending-locust.html">v0.7</a></dd>
        
        
        
        <dd><a href="http://docs.locust.io/en/v0.6.2/extending-locust.html">v0.6.2</a></dd>
        
        
        
        <dd><a href="http://docs.locust.io/en/v0.6.1/extending-locust.html">v0.6.1</a></dd>
        
        
        
        <dd><a href="http://docs.locust.io/en/v0.6/extending-locust.html">v0.6</a></dd>
        
        
        
        <dd><a href="http://docs.locust.io/en/v0.5.1/extending-locust.html">v0.5.1</a></dd>
        
        
        
        <dd><a href="http://docs.locust.io/en/0.4/extending-locust.html">0.4</a></dd>
        
        
      </dl>
      
      

      
      
      <dl>
        <dt>Downloads</dt>
        
        <dd><a href="https://readthedocs.org/projects/locust/downloads/pdf/stable/">PDF</a></dd>
        
        <dd><a href="https://readthedocs.org/projects/locust/downloads/htmlzip/stable/">HTML</a></dd>
        
        <dd><a href="https://readthedocs.org/projects/locust/downloads/epub/stable/">Epub</a></dd>
        
      </dl>
      
      

      
      <dl>
        <!-- These are kept as relative links for internal installs that are http -->
        <dt>On Read the Docs</dt>
        <dd>
          <a href="https://readthedocs.org/projects/locust/">Project Home</a>
        </dd>
        <dd>
          <a href="https://readthedocs.org/projects/locust/builds/">Builds</a>
        </dd>
        <dd>
          <a href="https://readthedocs.org/projects/locust/downloads/">Downloads</a>
        </dd>
      </dl>
      

      

      
      <dl>
        <dt>On GitHub</dt>
        <dd>
          <a href="https://github.com/locustio/locust/blob/4bde2ca90f28bde649ff4ce2c86e36a6e6260856/docs/extending-locust.rst">View</a>
        </dd>
        
      </dl>
      
      

      
      <dl>
        <dt>Search</dt>
        <dd>
          <div style="padding: 6px;">
            <form id="flyout-search-form" class="wy-form" target="_blank" action="https://readthedocs.org/projects/locust/search/" method="get">
              <input type="text" name="q" placeholder="Search docs">
              </form>
          </div>
        </dd>
      </dl>
      



      <hr>
      
        <small>
          <span>Hosted by <a href="https://readthedocs.org/">Read the Docs</a></span>
          <span> · </span>
          <a href="https://docs.readthedocs.io/page/privacy-policy.html">Privacy Policy</a>
        </small>
      

      

</div>
</div>
  </div>



  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.9.0',
            LANGUAGE:'en',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="./Locust 0.9.0文档11_files/jquery-2.0.3.min.js"></script>
      <script type="text/javascript" src="./Locust 0.9.0文档11_files/jquery-migrate-1.2.1.min.js"></script>
      <script type="text/javascript" src="./Locust 0.9.0文档11_files/underscore.js"></script>
      <script type="text/javascript" src="./Locust 0.9.0文档11_files/doctools.js"></script>
      <script type="text/javascript" src="./Locust 0.9.0文档11_files/readthedocs-doc-embed.js"></script>

  

  <script type="text/javascript" src="./Locust 0.9.0文档11_files/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script><div id="goog-gt-tt" class="skiptranslate" dir="ltr"><div style="padding: 8px;"><div><div class="logo"><img src="./Locust 0.9.0文档11_files/translate_24dp.png" width="20" height="20" alt="Google 翻译"></div></div></div><div class="top" style="padding: 8px; float: left; width: 100%;"><h1 class="title gray">原文</h1></div><div class="middle" style="padding: 8px;"><div class="original-text"></div></div><div class="bottom" style="padding: 8px;"><div class="activity-links"><span class="activity-link">提供更好的翻译建议</span><span class="activity-link"></span></div><div class="started-activity-container"><hr style="color: #CCC; background-color: #CCC; height: 1px; border: none;"><div class="activity-root"></div></div></div><div class="status-message" style="display: none;"></div></div> 


<div class="goog-te-spinner-pos"><div class="goog-te-spinner-animation"><svg xmlns="http://www.w3.org/2000/svg" class="goog-te-spinner" width="96px" height="96px" viewBox="0 0 66 66"><circle class="goog-te-spinner-path" fill="none" stroke-width="6" stroke-linecap="round" cx="33" cy="33" r="30"></circle></svg></div></div></body></html>