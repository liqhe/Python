<!DOCTYPE html>
<!-- saved from url=(0047)https://docs.locust.io/en/stable/changelog.html -->
<html class="js flexbox canvas canvastext webgl no-touch geolocation postmessage websqldatabase indexeddb hashchange history draganddrop websockets rgba hsla multiplebgs backgroundsize borderimage borderradius boxshadow textshadow opacity cssanimations csscolumns cssgradients cssreflections csstransforms csstransforms3d csstransitions fontface generatedcontent video audio localstorage sessionstorage webworkers applicationcache svg inlinesvg smil svgclippaths translated-ltr" lang="zh-CN" style=""><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>更改日志摘要 -  Locust 0.9.0文档</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="./Locust 0.9.0文档13_files/theme.css" type="text/css">
  <link rel="stylesheet" href="./Locust 0.9.0文档13_files/pygments.css" type="text/css">
    <link rel="index" title="指数" href="https://docs.locust.io/en/stable/genindex.html">
    <link rel="search" title="搜索" href="https://docs.locust.io/en/stable/search.html">
    <link rel="prev" title="第三方工具" href="https://docs.locust.io/en/stable/third-party-tools.html"> 

  
  <script async="" src="./Locust 0.9.0文档13_files/analytics.js"></script><script src="./Locust 0.9.0文档13_files/modernizr.min.js"></script>


<!-- RTD Extra Head -->

<!-- 
Always link to the latest version, as canonical.
http://docs.readthedocs.org/en/latest/canonical.html
-->
<link rel="canonical" href="http://docs.locust.io/en/stable/changelog.html">

<link rel="stylesheet" href="./Locust 0.9.0文档13_files/readthedocs-doc-embed.css" type="text/css">

<script type="text/javascript" src="./Locust 0.9.0文档13_files/readthedocs-data.js"></script>

<!-- Add page-specific data, which must exist in the page js, not global -->
<script type="text/javascript">
READTHEDOCS_DATA['page'] = 'changelog'
READTHEDOCS_DATA['source_suffix'] = '.rst'
</script>

<script type="text/javascript" src="./Locust 0.9.0文档13_files/readthedocs-analytics.js"></script>

<!-- end RTD <extrahead> -->
<link type="text/css" rel="stylesheet" charset="UTF-8" href="./Locust 0.9.0文档13_files/translateelement.css"></head>

<body class="wy-body-for-nav" style="">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="https://docs.locust.io/en/stable/index.html" class="icon icon-home"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 刺槐
          

          
          </font></font></a>

          
            
            
            
              <div class="version"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                稳定
              </font></font></div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="https://docs.locust.io/en/stable/search.html" method="get">
    <input type="text" name="q" placeholder="Search docs">
    <input type="hidden" name="check_keywords" value="yes">
    <input type="hidden" name="area" value="default">
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="https://docs.locust.io/en/stable/what-is-locust.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">什么是蝗虫？</font></font></a></li>
<li class="toctree-l1"><a class="reference internal" href="https://docs.locust.io/en/stable/installation.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安装</font></font></a></li>
<li class="toctree-l1"><a class="reference internal" href="https://docs.locust.io/en/stable/quickstart.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">快速开始</font></font></a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="https://docs.locust.io/en/stable/writing-a-locustfile.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">编写一个locustfile</font></font></a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="https://docs.locust.io/en/stable/running-locust-distributed.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">运行Locust分布式</font></font></a></li>
<li class="toctree-l1"><a class="reference internal" href="https://docs.locust.io/en/stable/running-locust-without-web-ui.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在没有Web UI的情况下运行Locust</font></font></a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="https://docs.locust.io/en/stable/retrieving-stats.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以CSV格式检索测试统计信息</font></font></a></li>
<li class="toctree-l1"><a class="reference internal" href="https://docs.locust.io/en/stable/testing-other-systems.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用自定义客户端测试其他系统</font></font></a></li>
<li class="toctree-l1"><a class="reference internal" href="https://docs.locust.io/en/stable/api.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API</font></font></a></li>
<li class="toctree-l1"><a class="reference internal" href="https://docs.locust.io/en/stable/extending-locust.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">扩大蝗虫</font></font></a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="https://docs.locust.io/en/stable/third-party-tools.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第三方工具</font></font></a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal current" href="https://docs.locust.io/en/stable/changelog.html#"><span class="toctree-expand"></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">变更日志亮点</font></font></a><ul>
<li class="toctree-l2"><a class="reference internal" href="https://docs.locust.io/en/stable/changelog.html#id1"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.9.0</font></font></a></li>
<li class="toctree-l2"><a class="reference internal" href="https://docs.locust.io/en/stable/changelog.html#id2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.8.1</font></font></a></li>
<li class="toctree-l2"><a class="reference internal" href="https://docs.locust.io/en/stable/changelog.html#id3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.8</font></font></a></li>
<li class="toctree-l2"><a class="reference internal" href="https://docs.locust.io/en/stable/changelog.html#id4"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.7.5</font></font></a></li>
<li class="toctree-l2"><a class="reference internal" href="https://docs.locust.io/en/stable/changelog.html#id5"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.7.4</font></font></a></li>
<li class="toctree-l2"><a class="reference internal" href="https://docs.locust.io/en/stable/changelog.html#id6"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.7.3</font></font></a></li>
<li class="toctree-l2"><a class="reference internal" href="https://docs.locust.io/en/stable/changelog.html#id7"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.7.2</font></font></a></li>
<li class="toctree-l2"><a class="reference internal" href="https://docs.locust.io/en/stable/changelog.html#id8"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.7.1</font></font></a></li>
<li class="toctree-l2"><a class="reference internal" href="https://docs.locust.io/en/stable/changelog.html#id9"><span class="toctree-expand"></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.7</font></font></a><ul>
<li class="toctree-l3"><a class="reference internal" href="https://docs.locust.io/en/stable/changelog.html#http-client-functionality-moved-to-httplocust"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTTP客户端功能已移至HttpLocust</font></font></a></li>
<li class="toctree-l3"><a class="reference internal" href="https://docs.locust.io/en/stable/changelog.html#msgpack-for-serializing-master-slave-data"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">msgpack用于序列化主/从数据</font></font></a></li>
<li class="toctree-l3"><a class="reference internal" href="https://docs.locust.io/en/stable/changelog.html#requests-updated-to-version-2-2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请求已更新至2.2版</font></font></a></li>
<li class="toctree-l3"><a class="reference internal" href="https://docs.locust.io/en/stable/changelog.html#gevent-updated-to-version-1-0"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gevent已更新至1.0版</font></font></a></li>
<li class="toctree-l3"><a class="reference internal" href="https://docs.locust.io/en/stable/changelog.html#big-refactoring-of-request-statistics-code"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请求统计代码的重构</font></font></a></li>
<li class="toctree-l3"><a class="reference internal" href="https://docs.locust.io/en/stable/changelog.html#removed-support-for-avg-wait"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">删除了对avg_wait的支持</font></font></a></li>
<li class="toctree-l3"><a class="reference internal" href="https://docs.locust.io/en/stable/changelog.html#removed-support-for-ramping">Removed support for ramping</a></li>
<li class="toctree-l3"><a class="reference internal" href="https://docs.locust.io/en/stable/changelog.html#locust-event-hooks-now-takes-keyword-argument">Locust Event hooks now takes keyword argument</a></li>
<li class="toctree-l3"><a class="reference internal" href="https://docs.locust.io/en/stable/changelog.html#other-changes">Other changes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="https://docs.locust.io/en/stable/changelog.html#id10"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.6.2</font></font></a></li>
<li class="toctree-l2"><a class="reference internal" href="https://docs.locust.io/en/stable/changelog.html#id11"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.6.1</font></font></a></li>
<li class="toctree-l2"><a class="reference internal" href="https://docs.locust.io/en/stable/changelog.html#id12"><span class="toctree-expand"></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.6</font></font></a><ul>
<li class="toctree-l3"><a class="reference internal" href="https://docs.locust.io/en/stable/changelog.html#sublocust-replaced-by-taskset-and-locust-class-behaviour-changed"><code class="docutils literal notranslate"><span class="pre">SubLocust</span></code> replaced by <code class="docutils literal notranslate"><span class="pre">TaskSet</span></code> and <code class="docutils literal notranslate"><span class="pre">Locust</span></code> class behaviour changed</a></li>
<li class="toctree-l3"><a class="reference internal" href="https://docs.locust.io/en/stable/changelog.html#locust-now-uses-requests"><span class="toctree-expand"></span>Locust now uses Requests</a><ul>
<li class="toctree-l4"><a class="reference internal" href="https://docs.locust.io/en/stable/changelog.html#gzip-encoding-turned-on-by-default">Gzip encoding turned on by default</a></li>
<li class="toctree-l4"><a class="reference internal" href="https://docs.locust.io/en/stable/changelog.html#improved-http-client">Improved HTTP client</a></li>
<li class="toctree-l4"><a class="reference internal" href="https://docs.locust.io/en/stable/changelog.html#httpsession-methods-catch-response-argument-improved-and-allow-http-error-argument-removed">HttpSession methods’ catch_response argument improved and allow_http_error argument removed</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="https://docs.locust.io/en/stable/changelog.html#other-improvements-and-bug-fixes">Other improvements and bug fixes</a></li>
<li class="toctree-l3"><a class="reference internal" href="https://docs.locust.io/en/stable/changelog.html#smaller-api-changes">Smaller API Changes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="https://docs.locust.io/en/stable/changelog.html#id13"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.5.1</font></font></a></li>
<li class="toctree-l2"><a class="reference internal" href="https://docs.locust.io/en/stable/changelog.html#id14"><span class="toctree-expand"></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.5</font></font></a><ul>
<li class="toctree-l3"><a class="reference internal" href="https://docs.locust.io/en/stable/changelog.html#api-changes">API changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="https://docs.locust.io/en/stable/changelog.html#improvements-and-bug-fixes">Improvements and bug fixes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="https://docs.locust.io/en/stable/changelog.html#id15"><span class="toctree-expand"></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.4</font></font></a><ul>
<li class="toctree-l3"><a class="reference internal" href="https://docs.locust.io/en/stable/changelog.html#id16">API changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="https://docs.locust.io/en/stable/changelog.html#id17">Improvements and bug fixes</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      <div id="rtd-68cuf9hj" class="ethical-rtd ethical-dark-theme"><div class="ethical-sidebar"><div class="ethical-content"><a href="https://readthedocs.org/sustainability/click/194/VTmEKEnZTErY/" rel="nofollow" target="_blank" class="ethical-image-link"><img src="./Locust 0.9.0文档13_files/english-house.png"></a><div class="ethical-text"><a href="https://readthedocs.org/sustainability/click/194/VTmEKEnZTErY/" rel="nofollow" target="_blank"><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当您使用“阅读文档”进行广告宣传时，每个月</font><b><font style="vertical-align: inherit;">达到700多万开发者</font></b></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></div></div><div class="ethical-callout"><small><em><a href="https://readthedocs.org/sustainability/advertising/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">赞助商</font></font></a><span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">· </font></font></span><a href="https://docs.readthedocs.io/en/latest/ethical-advertising.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">道德服务广告</font></font></a></em></small></div></div><img src="./Locust 0.9.0文档13_files/saved_resource" style="display: none;"></div></div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="https://docs.locust.io/en/stable/index.html">Locust</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="https://docs.locust.io/en/stable/index.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文件</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> »</font></font></li>
        
      <li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">变更日志亮点</font></font></li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/locustio/locust/blob/4bde2ca90f28bde649ff4ce2c86e36a6e6260856/docs/changelog.rst" class="fa fa-github"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 在GitHub上编辑</font></font></a>
            
          
        
      </li>
    
  </ul>

  
  <hr>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="changelog-highlights">
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更改日志摘要</font></font><a class="headerlink" href="https://docs.locust.io/en/stable/changelog.html#changelog-highlights" title="永久链接到这个标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h1>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有关Locust更改日志的完整详细信息，请参阅</font></font><a class="reference external" href="https://github.com/locustio/locust/CHANGELOG.md"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://github.com/locustio/locust/CHANGELOG.md</font></font></a></p>
<div class="section" id="id1">
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.9.0 </font></font><a class="headerlink" href="https://docs.locust.io/en/stable/changelog.html#id1" title="永久链接到这个标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h2>
<ul class="simple">
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">添加了详细的更改日志（</font></font><a class="reference external" href="https://github.com/locustio/locust/CHANGELOG.md"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://github.com/locustio/locust/CHANGELOG.md</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">许多错误修正（参见详细的更改日志）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">添加了顺序任务支持 - </font></font><a class="reference external" href="https://github.com/locustio/locust/pull/827"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://github.com/locustio/locust/pull/827</font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">添加了对用户定义的wait_function的支持 - </font></font><a class="reference external" href="https://github.com/locustio/locust/pull/785"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://github.com/locustio/locust/pull/785</font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认情况下，孵化完成后，Locust不再重置统计信息。</font><font style="vertical-align: inherit;">因此</font></font><code class="code docutils literal notranslate"><span class="pre">--no-reset-stats</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">已被删除（因为它现在是默认行为），而是</font></font><code class="code docutils literal notranslate"><span class="pre">--reset-stats</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">添加</font><font style="vertical-align: inherit;">了一个新</font><font style="vertical-align: inherit;">选项。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不再支持Python 3.3</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更新文档</font></font></li>
</ul>
</div>
<div class="section" id="id2">
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.8.1 </font></font><a class="headerlink" href="https://docs.locust.io/en/stable/changelog.html#id2" title="永久链接到这个标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h2>
<ul class="simple">
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更新了pyzmq版本，并进行了更改，以便我们不会固定特定版本。</font><font style="vertical-align: inherit;">这样可以更轻松地在Windows上安装Locust。</font></font></li>
</ul>
</div>
<div class="section" id="id3">
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.8 </font></font><a class="headerlink" href="https://docs.locust.io/en/stable/changelog.html#id3" title="永久链接到这个标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h2>
<ul class="simple">
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Python 3支持</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不再支持Python 2.6</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">添加了</font></font><code class="code docutils literal notranslate"><span class="pre">--no-reset-stats</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用于控制在孵化完成后是否应重置统计信息的选项</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">向Web UI添加了每秒请求数，平均响应时间和模拟用户数的图表。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更新了Web UI的设计。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">添加了通过命令行标志为结果写入CSV文件的功能</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将当前正在测试的主机的URL添加到Web UI。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们现在也应用gevent的猴子修补线程。</font><font style="vertical-align: inherit;">这解决了使用Locust测试Cassandra时的问题（</font></font><a class="reference external" href="https://github.com/locustio/locust/issues/569"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://github.com/locustio/locust/issues/569</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">各种错误修复和改进</font></font></li>
</ul>
</div>
<div class="section" id="id4">
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.7.5 </font></font><a class="headerlink" href="https://docs.locust.io/en/stable/changelog.html#id4" title="永久链接到这个标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h2>
<ul class="simple">
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用gevent 1.1.1版。</font><font style="vertical-align: inherit;">修复了某些版本的python上的安装问题。</font></font></li>
</ul>
</div>
<div class="section" id="id5">
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.7.4 </font></font><a class="headerlink" href="https://docs.locust.io/en/stable/changelog.html#id5" title="永久链接到这个标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h2>
<ul class="simple">
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用较新版本的请求，修复了使用旧版本请求获取ConnectionErrors的用户的问题（</font></font><a class="reference external" href="https://github.com/locustio/locust/issues/273"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://github.com/locustio/locust/issues/273</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">各种文档修复。</font></font></li>
</ul>
</div>
<div class="section" id="id6">
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.7.3 </font></font><a class="headerlink" href="https://docs.locust.io/en/stable/changelog.html#id6" title="永久链接到这个标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h2>
<ul class="simple">
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">修复了如果请求导致重定向，则POST请求（以及其他方法）被错误地报告为GET请求的错误。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">添加了以CSV格式下载例外的功能。</font><font style="vertical-align: inherit;">下载链接也已移至Web UI中的自己的选项卡。</font></font></li>
</ul>
</div>
<div class="section" id="id7">
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.7.2 </font></font><a class="headerlink" href="https://docs.locust.io/en/stable/changelog.html#id7" title="永久链接到这个标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h2>
<ul class="simple">
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当报告任何失败的请求时，Locust现在返回退出代码1。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当向使用重定向响应的端点发出HTTP请求时，请求的原始URL现在将用作统计信息中该条目的名称（除非通过</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">name</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数</font><font style="vertical-align: inherit;">指定显式覆盖</font><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">以前，重定向链中的最后一个URL用于标记统计信息中的请求。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">修复了仅导致重定向链中最后一个请求的时间包含在报告时间内的错误。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">修复了导致请求体的下载时间不包含在报告的响应时间内的错误。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">修复了一些篡改python-requests系统包的linux dists上发生的错误（删除请求捆绑的依赖项）。</font><font style="vertical-align: inherit;">这个bug只在python系统包中安装Locust时发生，而不是在使用virtualenv时发生。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">各种小修复和改进。</font></font></li>
</ul>
</div>
<div class="section" id="id8">
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.7.1 </font></font><a class="headerlink" href="https://docs.locust.io/en/stable/changelog.html#id8" title="永久链接到这个标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h2>
<ul class="simple">
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">现在，默认情况下会捕获TaskSet中发生的异常。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">修复了在所有蝗虫孵化并重置统计数据后导致最小响应时间始终为0的错误。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Web界面中的少量UI改进。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过忽略消息并在主进程中创建日志条目来处理来自“zombie”从属的消息。</font></font></li>
</ul>
</div>
<div class="section" id="id9">
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.7 </font></font><a class="headerlink" href="https://docs.locust.io/en/stable/changelog.html#id9" title="永久链接到这个标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h2>
<div class="section" id="http-client-functionality-moved-to-httplocust">
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTTP客户端功能转移到HttpLocust </font></font><a class="headerlink" href="https://docs.locust.io/en/stable/changelog.html#http-client-functionality-moved-to-httplocust" title="永久链接到这个标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h3>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以前，Locust类</font></font><a class="reference internal" href="https://docs.locust.io/en/stable/api.html#locust.clients.HttpSession" title="locust.clients.HttpSession"><code class="xref py py-class docutils literal notranslate"><span class="pre">HttpSession</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在用于发出HTTP请求的client属性下</font><font style="vertical-align: inherit;">实例化a </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这个功能现在已经被移到了</font></font><a class="reference internal" href="https://docs.locust.io/en/stable/api.html#locust.core.HttpLocust" title="locust.core.HttpLocust"><code class="xref py py-class docutils literal notranslate"><span class="pre">HttpLocust</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类中，以便更明显地如何使用Locust来
 </font></font><a class="reference internal" href="https://docs.locust.io/en/stable/testing-other-systems.html"><span class="doc"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">加载测试非HTTP系统</font></font></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要使现有的蝗虫脚本与新版本兼容，您应该使您的蝗虫类继承自HttpLocust而不是基本的Locust类。</font></font></p>
</div>
<div class="section" id="msgpack-for-serializing-master-slave-data">
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">msgpack用于序列化的主/从数据</font></font><a class="headerlink" href="https://docs.locust.io/en/stable/changelog.html#msgpack-for-serializing-master-slave-data" title="永久链接到这个标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h3>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Locust现在使用</font></font><a class="reference external" href="http://msgpack.org/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">msgpack</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来序列化在主节点和它的从属节点之间发送的数据。</font><font style="vertical-align: inherit;">如果可以访问用于主从通信的内部蝗虫端口，则可以用来执行远程执行代码的攻击。</font><font style="vertical-align: inherit;">这种利用的原因是由于使用了泡菜。</font></font></p>
<div class="admonition warning">
<p class="first admonition-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">警告</font></font></p>
<p class="last"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用旧版本的任何人都应该确保他们的Locust机器不能在端口5557和5558上公开访问。此外，不应该以root用户身份运行Locust。</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font></font><a class="reference internal" href="https://docs.locust.io/en/stable/api.html#locust.events.report_to_master" title="locust.events.report_to_master"><code class="xref py py-class docutils literal notranslate"><span class="pre">report_to_master</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
 </font></font><a class="reference internal" href="https://docs.locust.io/en/stable/api.html#locust.events.slave_report" title="locust.events.slave_report"><code class="xref py py-class docutils literal notranslate"><span class="pre">slave_report</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">事件的</font><font style="vertical-align: inherit;">任何人都</font><font style="vertical-align: inherit;">需要确保附加到从属报告的任何数据都可以通过msgpack进行序列化。</font></font></p>
</div>
<div class="section" id="requests-updated-to-version-2-2">
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请求更新到2.2版</font></font><a class="headerlink" href="https://docs.locust.io/en/stable/changelog.html#requests-updated-to-version-2-2" title="永久链接到这个标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h3>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Locust更新</font><font style="vertical-align: inherit;">了对最新主要版本的</font></font><a class="reference external" href="http://python-requests.org/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请求</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
<div class="admonition note">
<p class="first admonition-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注意</font></font></p>
<p class="last"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请求1.0引入了一些主要的API更改（和2.0只是一些）。</font><font style="vertical-align: inherit;">请检查您是否使用任何内部功能并查看文档：
 </font></font><a class="reference external" href="http://docs.python-requests.org/en/latest/api/#migrating-to-1-x"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">迁移到1.x</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
 </font></font><a class="reference external" href="http://docs.python-requests.org/en/latest/api/#migrating-to-2-x"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">迁移到2.x.</font></font></a></p>
</div>
</div>
<div class="section" id="gevent-updated-to-version-1-0">
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GEVENT更新到1.0版本</font></font><a class="headerlink" href="https://docs.locust.io/en/stable/changelog.html#gevent-updated-to-version-1-0" title="永久链接到这个标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h3>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gevent 1.0现已发布，Locust已相应更新。</font></font></p>
</div>
<div class="section" id="big-refactoring-of-request-statistics-code">
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请求统计代码的重构</font></font><a class="headerlink" href="https://docs.locust.io/en/stable/changelog.html#big-refactoring-of-request-statistics-code" title="永久链接到这个标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h3>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重构</font></font><code class="xref py py-class docutils literal notranslate"><span class="pre">RequestStats</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
<ul class="simple">
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">已创建</font></font><code class="xref py py-class docutils literal notranslate"><span class="pre">StatsEntry</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，表示单个统计信息条目（URL）。</font></font></li>
</ul>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以前</font></font><code class="xref py py-class docutils literal notranslate"><span class="pre">RequestStats</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实际上是做了两件事：</font></font></p>
<ul class="simple">
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">它记录了所有请求的汇总统计数据</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">它持有单个统计数据条目的统计数据。</font></font></li>
</ul>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">现在RequestStats应该被实例化并保存全局统计信息，以及StatsEntry实例的dict，其中包含单个统计信息条目（URL）的统计信息</font></font></p>
</div>
<div class="section" id="removed-support-for-avg-wait">
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">删除了对avg_wait的支持</font></font><a class="headerlink" href="https://docs.locust.io/en/stable/changelog.html#removed-support-for-avg-wait" title="永久链接到这个标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h3>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以前可以指定avg_wait，</font></font><code class="xref py py-class docutils literal notranslate"><span class="pre">TaskSet</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并且</font></font><code class="xref py py-class docutils literal notranslate"><span class="pre">Locust</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Locust会努力尝试。</font><font style="vertical-align: inherit;">但是，对于大多数用例，使用min_wait和max_wait可以充分实现这一点。</font><font style="vertical-align: inherit;">因此我们决定删除avg_wait，因为它的用例不清楚或者太窄而不能进入Locust核心。</font></font></p>
</div>
<div class="section" id="removed-support-for-ramping">
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">删除了对斜坡的支持</font></font><a class="headerlink" href="https://docs.locust.io/en/stable/changelog.html#removed-support-for-ramping" title="永久链接到这个标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h3>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以前可以使用-ramp选项告诉Locust尝试找到目标主机可以处理的稳定客户端计数，但是它已被破坏并且没有记录很长一段时间所以我们决定将它从蝗虫核心中移除也许它会在未来重新出现作为一个插件。</font></font></p>
</div>
<div class="section" id="locust-event-hooks-now-takes-keyword-argument">
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Locust Event钩子现在接受关键字参数</font></font><a class="headerlink" href="https://docs.locust.io/en/stable/changelog.html#locust-event-hooks-now-takes-keyword-argument" title="永久链接到这个标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h3>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当</font></font><a class="reference internal" href="https://docs.locust.io/en/stable/extending-locust.html"><span class="doc"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">扩展蝗虫</font></font></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过听取</font></font><a class="reference internal" href="https://docs.locust.io/en/stable/api.html#events"><span class="std std-ref"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">事件挂钩</font></font></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，监听功能，现在应该期望参数作为关键字参数传递。</font><font style="vertical-align: inherit;">强烈建议在侦听器函数中添加额外的通配符关键字参数，因为如果在将来的某个版本中将额外的参数添加到该事件，则它们不太可能中断。</font><font style="vertical-align: inherit;">例如：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">locust</span> <span class="k">import</span> <span class="n">events</span>

<span class="k">def</span> <span class="nf">on_request</span><span class="p">(</span><span class="n">request_type</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">response_time</span><span class="p">,</span> <span class="n">response_length</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="nb">print</span> <span class="s2">"Got request!"</span>

<span class="n">locust</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">request_success</span> <span class="o">+=</span> <span class="n">on_request</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">路径</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数</font></font><a class="reference internal" href="https://docs.locust.io/en/stable/api.html#locust.events.request_success" title="locust.events.request_success"><code class="xref py py-obj docutils literal notranslate"><span class="pre">request_success</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
 </font></font><a class="reference internal" href="https://docs.locust.io/en/stable/api.html#locust.events.request_failure" title="locust.events.request_failure"><code class="xref py py-obj docutils literal notranslate"><span class="pre">request_failure</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">现在被称为</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">request_type</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">名字</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，因为它是少HTTP具体。</font></font></p>
</div>
<div class="section" id="other-changes">
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">其他变化</font></font><a class="headerlink" href="https://docs.locust.io/en/stable/changelog.html#other-changes" title="永久链接到这个标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h3>
<ul class="simple">
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您现在可以指定运行Web主机的端口</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">各种代码清理</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更新了gevent / zmq库</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">切换到unittest2发现</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">添加了-only-summary选项，仅将摘要输出到控制台，从而禁用了周期性统计输出。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">现在，蝗虫将确保以分布式模式生成所有指定的蝗虫，而不仅仅是奴隶数量的倍数。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">修复了破碎的Vagrant示例。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">修复了已损坏的事件示例（events.py）。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">修复了请求列在web-ui中无法排序的问题。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">web-ui中统计表的次要样式。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">添加了以分布式模式指定主机和端口的选项，使用-master-host，-master-port表示从站，-master-bind-host，-master-bind-port表示主站。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">删除了以前弃用和过时的类WebLocust和SubLocust。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">已修复，以便在命令行上指定最大请求数时，请求计数也会失败</font></font></li>
</ul>
</div>
</div>
<div class="section" id="id10">
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.6.2 </font></font><a class="headerlink" href="https://docs.locust.io/en/stable/changelog.html#id10" title="永久链接到这个标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h2>
<ul class="simple">
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使Locust与gevent 1.0rc2兼容。</font><font style="vertical-align: inherit;">这允许用户在某些版本的CentOS下解决运行Locust的问题，可以通过将gevent升级到1.0来修复。</font></font></li>
<li><font style="vertical-align: inherit;"></font><a class="reference internal" href="https://docs.locust.io/en/stable/api.html#locust.core.TaskSet.parent" title="locust.core.TaskSet.parent"><code class="xref py py-attr docutils literal notranslate"><span class="pre">parent</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">向TaskSet类</font><font style="vertical-align: inherit;">添加</font><font style="vertical-align: inherit;">了引用父TaskSet或Locust实例的属性。</font><font style="vertical-align: inherit;">由Aaron Daubman供稿。</font></font></li>
</ul>
</div>
<div class="section" id="id11">
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.6.1 </font></font><a class="headerlink" href="https://docs.locust.io/en/stable/changelog.html#id11" title="永久链接到这个标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h2>
<ul class="simple">
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">修复了使用</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-n</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-num-request</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令行参数</font><font style="vertical-align: inherit;">设置最大请求数时导致问题的错误
 </font><font style="vertical-align: inherit;">。</font></font></li>
</ul>
</div>
<div class="section" id="id12">
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.6 </font></font><a class="headerlink" href="https://docs.locust.io/en/stable/changelog.html#id12" title="永久链接到这个标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h2>
<div class="admonition warning">
<p class="first admonition-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">警告</font></font></p>
<p class="last"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">此版本附带API的非向后兼容更改。</font><font style="vertical-align: inherit;">目前正在使用现有的locust脚本并希望升级到0.6的任何人都应该阅读这些更改。</font></font></p>
</div>
<div class="section" id="sublocust-replaced-by-taskset-and-locust-class-behaviour-changed">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">SubLocust</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">替换为</font></font><a class="reference internal" href="https://docs.locust.io/en/stable/api.html#locust.core.TaskSet" title="locust.core.TaskSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">TaskSet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><a class="reference internal" href="https://docs.locust.io/en/stable/api.html#locust.core.Locust" title="locust.core.Locust"><code class="xref py py-class docutils literal notranslate"><span class="pre">Locust</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类行为改变</font></font><a class="headerlink" href="https://docs.locust.io/en/stable/changelog.html#sublocust-replaced-by-taskset-and-locust-class-behaviour-changed" title="永久链接到这个标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h3>
<p><a class="reference internal" href="https://docs.locust.io/en/stable/api.html#locust.core.Locust" title="locust.core.Locust"><code class="xref py py-class docutils literal notranslate"><span class="pre">Locust</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类不再控制任务调度和执行。</font><font style="vertical-align: inherit;">因此，您不再在Locust类中定义任务，而是Locust类具有</font></font><a class="reference internal" href="https://docs.locust.io/en/stable/api.html#locust.core.Locust.task_set" title="locust.core.Locust.task_set"><code class="xref py py-attr docutils literal notranslate"><span class="pre">task_set</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">应指向</font><font style="vertical-align: inherit;">类的
 </font><font style="vertical-align: inherit;">属性
 </font></font><a class="reference internal" href="https://docs.locust.io/en/stable/api.html#locust.core.TaskSet" title="locust.core.TaskSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">TaskSet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">现在应该在TaskSet类中定义任务，方法与之前在Locust和SubLocust类中完成的方式相同。</font><font style="vertical-align: inherit;">TaskSets可以像SubLocust类一样嵌套。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">所以0.5.1的代码如下：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">User</span><span class="p">(</span><span class="n">Locust</span><span class="p">):</span>
    <span class="n">min_wait</span> <span class="o">=</span> <span class="mi">10000</span>
    <span class="n">max_wait</span> <span class="o">=</span> <span class="mi">120000</span>

    <span class="nd">@task</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"/"</span><span class="p">)</span>

    <span class="nd">@task</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">class</span> <span class="nc">AboutPage</span><span class="p">(</span><span class="n">SubLocust</span><span class="p">):</span>
        <span class="n">min_wait</span> <span class="o">=</span> <span class="mi">10000</span>
        <span class="n">max_wait</span> <span class="o">=</span> <span class="mi">120000</span>

        <span class="k">def</span> <span class="nf">on_init</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"/about/"</span><span class="p">)</span>

        <span class="nd">@task</span>
        <span class="k">def</span> <span class="nf">team_page</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"/about/team/"</span><span class="p">)</span>

        <span class="nd">@task</span>
        <span class="k">def</span> <span class="nf">press_page</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"/about/press/"</span><span class="p">)</span>

        <span class="nd">@task</span>
        <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">interrupt</span><span class="p">()</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">现在应该写成：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">BrowsePage</span><span class="p">(</span><span class="n">TaskSet</span><span class="p">):</span>
    <span class="nd">@task</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"/"</span><span class="p">)</span>

    <span class="nd">@task</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">class</span> <span class="nc">AboutPage</span><span class="p">(</span><span class="n">TaskSet</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">on_init</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"/about/"</span><span class="p">)</span>

        <span class="nd">@task</span>
        <span class="k">def</span> <span class="nf">team_page</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"/about/team/"</span><span class="p">)</span>

        <span class="nd">@task</span>
        <span class="k">def</span> <span class="nf">press_page</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"/about/press/"</span><span class="p">)</span>

        <span class="nd">@task</span>
        <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">interrupt</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">User</span><span class="p">(</span><span class="n">Locust</span><span class="p">):</span>
    <span class="n">min_wait</span> <span class="o">=</span> <span class="mi">10000</span>
    <span class="n">max_wait</span> <span class="o">=</span> <span class="mi">120000</span>
    <span class="n">task_set</span> <span class="o">=</span> <span class="n">BrowsePage</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">每个TaskSet实例都获取一个</font></font><a class="reference internal" href="https://docs.locust.io/en/stable/api.html#locust.core.TaskSet.locust" title="locust.core.TaskSet.locust"><code class="xref py py-attr docutils literal notranslate"><span class="pre">locust</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性，该属性引用Locust类。</font></font></p>
</div>
<div class="section" id="locust-now-uses-requests">
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">蝗虫现在使用要求</font></font><a class="headerlink" href="https://docs.locust.io/en/stable/changelog.html#locust-now-uses-requests" title="永久链接到这个标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h3>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Locust自己的HttpBrowser类（通常通过</font><font style="vertical-align: inherit;">来自locust类中的</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.client</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">访问</font><font style="vertical-align: inherit;">）已经被请求库（</font></font><a class="reference external" href="http://python-requests.org/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://python-requests.org</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">周围的瘦包装器所取代</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这带来了许多优点。</font><font style="vertical-align: inherit;">用户现在可以利用记录良好，编写良好，完全成熟的库来发出HTTP请求。</font><font style="vertical-align: inherit;">但是，它还附带了一些小的API更改，这些更改将要求用户更新其现有的负载测试脚本。</font></font></p>
<div class="section" id="gzip-encoding-turned-on-by-default">
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gzip编码默认打开</font></font><a class="headerlink" href="https://docs.locust.io/en/stable/changelog.html#gzip-encoding-turned-on-by-default" title="永久链接到这个标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h4>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTTP客户端现在默认发送用于接受gzip编码的标头。</font><font style="vertical-align: inherit;">该</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-gzip</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">命令行参数已被删除，如果有人想禁用</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的Accept-Encoding</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的HTTP客户端使用，或任何其他HTTP头，你可以这样做：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyWebUser</span><span class="p">(</span><span class="n">Locust</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">on_start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"Accept-Encoding"</span><span class="p">:</span><span class="s2">""</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="improved-http-client">
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">改进的HTTP客户端</font></font><a class="headerlink" href="https://docs.locust.io/en/stable/changelog.html#improved-http-client" title="永久链接到这个标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h4>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">由于在HTTP客户端中切换到使用python-requests，客户端的API也发生了一些变化。</font></font></p>
<ul>
<li><p class="first"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">此外，对于</font></font><a class="reference internal" href="https://docs.locust.io/en/stable/api.html#locust.clients.HttpSession.get" title="locust.clients.HttpSession.get"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><a class="reference internal" href="https://docs.locust.io/en/stable/api.html#locust.clients.HttpSession.post" title="locust.clients.HttpSession.post"><code class="xref py py-meth docutils literal notranslate"><span class="pre">post</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
 </font></font><a class="reference internal" href="https://docs.locust.io/en/stable/api.html#locust.clients.HttpSession.put" title="locust.clients.HttpSession.put"><code class="xref py py-meth docutils literal notranslate"><span class="pre">put</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><a class="reference internal" href="https://docs.locust.io/en/stable/api.html#locust.clients.HttpSession.delete" title="locust.clients.HttpSession.delete"><code class="xref py py-meth docutils literal notranslate"><span class="pre">delete</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
 </font></font><a class="reference internal" href="https://docs.locust.io/en/stable/api.html#locust.clients.HttpSession.head" title="locust.clients.HttpSession.head"><code class="xref py py-meth docutils literal notranslate"><span class="pre">head</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法的</font></font><a class="reference internal" href="https://docs.locust.io/en/stable/api.html#locust.clients.HttpSession" title="locust.clients.HttpSession"><code class="xref py py-class docutils literal notranslate"><span class="pre">HttpSession</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类现在也有</font></font><a class="reference internal" href="https://docs.locust.io/en/stable/api.html#locust.clients.HttpSession.patch" title="locust.clients.HttpSession.patch"><code class="xref py py-meth docutils literal notranslate"><span class="pre">patch</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><a class="reference internal" href="https://docs.locust.io/en/stable/api.html#locust.clients.HttpSession.options" title="locust.clients.HttpSession.options"><code class="xref py py-meth docutils literal notranslate"><span class="pre">options</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法。</font></font></p>
</li>
<li><p class="first"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">现在</font><font style="vertical-align: inherit;">，除了</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">url</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">data</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">之外，HTTP请求方法的所有参数</font><font style="vertical-align: inherit;">都应指定为关键字参数。</font><font style="vertical-align: inherit;">例如，以前可以使用以下命令指定标头：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"/path"</span><span class="p">,</span> <span class="p">{</span><span class="s2">"User-Agent"</span><span class="p">:</span><span class="s2">"locust"</span><span class="p">})</span> <span class="c1"># this will no longer work</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">现在应该指定如下：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"/path"</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">"User-Agent"</span><span class="p">:</span><span class="s2">"locust"</span><span class="p">})</span>
</pre></div>
</div>
</li>
<li><p class="first"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通常，整个HTTP客户端现在更强大，因为它利用了python请求。</font><font style="vertical-align: inherit;">我们现在能够在Locust中使用的功能包括文件上传，SSL，连接保持活动等。</font><font style="vertical-align: inherit;">有关</font><font style="vertical-align: inherit;">更多详细信息，</font><font style="vertical-align: inherit;">请参阅</font></font><a class="reference external" href="http://python-requests.org/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">python-requests文档</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</li>
<li><p class="first"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新</font></font><a class="reference internal" href="https://docs.locust.io/en/stable/api.html#locust.clients.HttpSession" title="locust.clients.HttpSession"><code class="xref py py-class docutils literal notranslate"><span class="pre">HttpSession</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类'方法现在返回python-request
 </font></font><a class="reference external" href="https://requests.readthedocs.io/en/latest/api/#requests.Response" title="（在请求v2.19.1中）"><code class="xref py py-class docutils literal notranslate"><span class="pre">Response</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对象。</font><font style="vertical-align: inherit;">这意味着不再使用</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">data</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font><font style="vertical-align: inherit;">访问响应</font><font style="vertical-align: inherit;">的</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">内容</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，而是使用</font><strong><font style="vertical-align: inherit;">content</font></strong><font style="vertical-align: inherit;">属性。</font><font style="vertical-align: inherit;">现在通过</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">status_code</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性而不是</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">代码</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font><font style="vertical-align: inherit;">访问HTTP响应代码</font><font style="vertical-align: inherit;">。</font></font></p>
</li>
</ul>
</div>
<div class="section" id="httpsession-methods-catch-response-argument-improved-and-allow-http-error-argument-removed">
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HttpSession方法'catch_response参数改进，allow_http_error参数被删除</font></font><a class="headerlink" href="https://docs.locust.io/en/stable/changelog.html#httpsession-methods-catch-response-argument-improved-and-allow-http-error-argument-removed" title="永久链接到这个标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h4>
<ul>
<li><p class="first"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当进行使用HTTP请求</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">catch_response</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数，返回的上下文管理器现在提供两种功能，</font></font><a class="reference internal" href="https://docs.locust.io/en/stable/api.html#locust.clients.ResponseContextManager.success" title="locust.clients.ResponseContextManager.success"><code class="xref py py-meth docutils literal notranslate"><span class="pre">success</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并且
 </font></font><a class="reference internal" href="https://docs.locust.io/en/stable/api.html#locust.clients.ResponseContextManager.failure" title="locust.clients.ResponseContextManager.failure"><code class="xref py py-meth docutils literal notranslate"><span class="pre">failure</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可用于手动控制什么样的要求，应报告为蝗虫的统计数据。</font></font></p>
<dl class="class">
<dt>
<em class="property"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类</font></font></em><code class="descname">ResponseContextManager</code><span class="sig-paren"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font></span><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">响应</font></font></em><span class="sig-paren"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font></font></span></dt>
<dd><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一个Response类，它还充当上下文管理器，提供手动控制是否应将HTTP请求标记为成功或者是否在Locust的统计信息中失败的功能</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这个类是</font></font><a class="reference external" href="https://requests.readthedocs.io/en/latest/api/#requests.Response" title="（在请求v2.19.1中）"><code class="xref py py-class docutils literal notranslate"><span class="pre">Response</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">另外两个方法</font><font style="vertical-align: inherit;">的子类</font><font style="vertical-align: inherit;">：</font></font><a class="reference internal" href="https://docs.locust.io/en/stable/api.html#locust.clients.ResponseContextManager.success" title="locust.clients.ResponseContextManager.success"><code class="xref py py-meth docutils literal notranslate"><span class="pre">success</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和 
 </font></font><a class="reference internal" href="https://docs.locust.io/en/stable/api.html#locust.clients.ResponseContextManager.failure" title="locust.clients.ResponseContextManager.failure"><code class="xref py py-meth docutils literal notranslate"><span class="pre">failure</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
<dl class="method">
<dt>
<code class="descname">failure</code><span class="sig-paren"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font></span><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exc </font></font></em><span class="sig-paren"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font></font></span></dt>
<dd><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将响应报告为失败。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exc可以是python异常，也可以是字符串，在这种情况下，它将被包装在CatchResponseError中。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"/"</span><span class="p">,</span> <span class="n">catch_response</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">response</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">content</span> <span class="o">==</span> <span class="sa">b</span><span class="s2">""</span><span class="p">:</span>
        <span class="n">response</span><span class="o">.</span><span class="n">failure</span><span class="p">(</span><span class="s2">"No data"</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">success</code><span class="sig-paren"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font></span><span class="sig-paren"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font></font></span></dt>
<dd><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">报告回复成功</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"/does/not/exist"</span><span class="p">,</span> <span class="n">catch_response</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">response</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">404</span><span class="p">:</span>
        <span class="n">response</span><span class="o">.</span><span class="n">success</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</li>
<li><p class="first"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">已删除HTTP客户端方法</font><font style="vertical-align: inherit;">的</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">allow_http_error</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数。</font><font style="vertical-align: inherit;">相反，可以使用
 </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">catch_response</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数来获取上下文管理器，该管理器可以与with语句一起使用。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以前的Locust版本中的以下代码：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"/does/not/exist"</span><span class="p">,</span> <span class="n">allow_http_error</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">现在可以写成：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"/does/not/exist"</span><span class="p">,</span> <span class="n">catch_response</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">response</span><span class="p">:</span>
    <span class="n">response</span><span class="o">.</span><span class="n">success</span><span class="p">()</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>
<div class="section" id="other-improvements-and-bug-fixes">
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">其他改进和错误修复</font></font><a class="headerlink" href="https://docs.locust.io/en/stable/changelog.html#other-improvements-and-bug-fixes" title="永久链接到这个标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h3>
<ul class="simple">
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">计划任务callables现在可以获取关键字参数，而不仅仅是普通函数参数。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用调度的SubLocust类</font></font><code class="xref py py-func docutils literal notranslate"><span class="pre">locust.core.Locust.schedule_task()</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">现在可以</font><font style="vertical-align: inherit;">使用</font><font style="vertical-align: inherit;">参数和关键字参数（在</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.args</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.kwargs中</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可用</font><font style="vertical-align: inherit;">）。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">修复了针对未设置内容长度标头的服务器（即使用</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Transfer-Encoding的</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">服务器</font><em><font style="vertical-align: inherit;">：chunked</font></em><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">执行请求时平均内容大小为零的错误</font></font></li>
</ul>
</div>
<div class="section" id="smaller-api-changes">
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">较小的API更改</font></font><a class="headerlink" href="https://docs.locust.io/en/stable/changelog.html#smaller-api-changes" title="永久链接到这个标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h3>
<ul class="simple">
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">require_once</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">装饰已被删除。</font><font style="vertical-align: inherit;">这是一个旧的遗留函数，不再符合当前编写Locust测试的方式，其中任务是Locust类下的方法或包含任务方法的SubLocust类。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">改变了签名</font></font><code class="xref py py-func docutils literal notranslate"><span class="pre">locust.core.Locust.schedule_task()</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">以前，所有给该方法的额外参数都会在调用时传递给该任务。</font><font style="vertical-align: inherit;">它不再接受额外的论点。</font><font style="vertical-align: inherit;">相反，它需要一个</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">args</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数（列表）和一个</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kwargs</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数（dict），它们在被调用时被传递给任务。</font></font></li>
<li><font style="vertical-align: inherit;"></font><a class="reference internal" href="https://docs.locust.io/en/stable/api.html#locust.events.request_success" title="locust.events.request_success"><code class="xref py py-class docutils literal notranslate"><span class="pre">request_success</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">事件挂钩的</font><font style="vertical-align: inherit;">参数</font><font style="vertical-align: inherit;">已更改。</font><font style="vertical-align: inherit;">以前它将HTTP响应实例作为参数，但是已经更改为取代响应的内容长度。</font><font style="vertical-align: inherit;">这样可以更轻松地为Locust编写自定义客户端。</font></font></li>
</ul>
</div>
</div>
<div class="section" id="id13">
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.5.1 </font></font><a class="headerlink" href="https://docs.locust.io/en/stable/changelog.html#id13" title="永久链接到这个标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h2>
<ul class="simple">
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">修复了在没有zeromq的情况下运行locust时导致-logfile和-loglevel命令行参数不被遵守的错误。</font></font></li>
</ul>
</div>
<div class="section" id="id14">
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.5 </font></font><a class="headerlink" href="https://docs.locust.io/en/stable/changelog.html#id14" title="永久链接到这个标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h2>
<div class="section" id="api-changes">
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API更改</font></font><a class="headerlink" href="https://docs.locust.io/en/stable/changelog.html#api-changes" title="永久链接到这个标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h3>
<ul class="simple">
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Web界面现在默认打开。</font><font style="vertical-align: inherit;">该</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">织网</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的命令行选项已被取代-无-网络。</font></font></li>
<li><a class="reference internal" href="https://docs.locust.io/en/stable/api.html#locust.events.request_success" title="locust.events.request_success"><code class="xref py py-func docutils literal notranslate"><span class="pre">locust.events.request_success()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">  而</font></font><a class="reference internal" href="https://docs.locust.io/en/stable/api.html#locust.events.request_failure" title="locust.events.request_failure"><code class="xref py py-func docutils literal notranslate"><span class="pre">locust.events.request_failure()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">现在得到的HTTP方法作为第一个参数。</font></font></li>
</ul>
</div>
<div class="section" id="improvements-and-bug-fixes">
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">改进和错误修复</font></font><a class="headerlink" href="https://docs.locust.io/en/stable/changelog.html#improvements-and-bug-fixes" title="永久链接到这个标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h3>
<ul class="simple">
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">删除了</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-show-task-ratio-confluence</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并添加了</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-show-task-ratio-json</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选项。</font><font style="vertical-align: inherit;">所述
 </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-show任务比-JSON</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将输出包含为刺槐“大脑”任务的执行比率JSON数据。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">客户端请求URL时使用的HTTP方法现在显示在Web UI中</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">统计信息输出中的一些修复和改进：</font></font></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">下载统计信息时，现在设置文件名（使用内容处置标头）。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请求统计信息的列标题的顺序错误。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">感谢Benjamin W. Smith，Jussi Kuosa和Samuele Pedroni！</font></font></li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="id15">
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0.4 </font></font><a class="headerlink" href="https://docs.locust.io/en/stable/changelog.html#id15" title="永久链接到这个标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h2>
<div class="section" id="id16">
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API更改</font></font><a class="headerlink" href="https://docs.locust.io/en/stable/changelog.html#id16" title="永久链接到这个标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h3>
<ul class="simple">
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WebLocust类已被弃用，现在称为Locust。</font><font style="vertical-align: inherit;">以前称为Locust的类现在称为LocustBase。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HttpClient.get（）和HttpClient.post（）</font><font style="vertical-align: inherit;">的</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">catch_http_error</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数已重命名为
 </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">allow_http_error</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></li>
</ul>
</div>
<div class="section" id="id17">
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">改进和错误修复</font></font><a class="headerlink" href="https://docs.locust.io/en/stable/changelog.html#id17" title="永久链接到这个标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h3>
<ul class="simple">
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Locust现在使用python的日志记录模块进行所有日志记录</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">添加了在测试运行时更改生成的用户数的功能，而无需重新启动测试。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实验支持自动增加和减少蝗虫数量以找到最大并发用户数（基于一些参数，如响应时间和可接受的故障率）。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">即使HTTP响应正常，也会根据响应数据添加对失败请求的支持。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">改进主节点性能，以便在使用足够的从设备时不会出现瓶颈（&gt; 100）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Web界面的微小改进。</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">修复了MANIFEST文件中缺少的模板目录，导致安装了“setup.py install”的蝗虫无法正常工作。</font></font></li>
</ul>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="https://docs.locust.io/en/stable/third-party-tools.html" class="btn btn-neutral" title="第三方工具" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 以前</font></font></a>
      
    </div>
  

  <hr><div><div id="rtd-gdpdwshs" class="ethical-rtd"></div></div>

  <div role="contentinfo">
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        ©版权所有。
      
        </font></font><span class="commit"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          修订</font></font><code>4bde2ca9</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
        </font></font></span>
      

    </p>
  </div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font><a href="https://readthedocs.org/"><font style="vertical-align: inherit;">Read the Docs</font></a><font style="vertical-align: inherit;">提供</font><font style="vertical-align: inherit;">的</font><a href="https://github.com/rtfd/sphinx_rtd_theme"><font style="vertical-align: inherit;">主题</font></a><font style="vertical-align: inherit;"> 
  使用</font></font><a href="http://sphinx-doc.org/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sphinx</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">构建</font><font style="vertical-align: inherit;">。 

</font></font><a href="https://github.com/rtfd/sphinx_rtd_theme"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><a href="https://readthedocs.org/"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font></footer>

        </div>
      </div>

    </section>

  </div>
  

  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">阅读文档</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
      v：stable
      </font></font><span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions"><!-- Inserted RTD Footer -->
<div class="injected">

  

      
      
      
      <dl>
        <dt>Versions</dt>
        
        
        <dd><a href="http://docs.locust.io/en/latest/changelog.html">latest</a></dd>
        
        
         <strong> 
        <dd><a href="http://docs.locust.io/en/stable/changelog.html">stable</a></dd>
         </strong> 
        
        
        <dd><a href="http://docs.locust.io/en/0.9.0/changelog.html">0.9.0</a></dd>
        
        
        
        <dd><a href="http://docs.locust.io/en/v0.8.1/changelog.html">v0.8.1</a></dd>
        
        
        
        <dd><a href="http://docs.locust.io/en/v0.8/changelog.html">v0.8</a></dd>
        
        
        
        <dd><a href="http://docs.locust.io/en/v0.7.5/changelog.html">v0.7.5</a></dd>
        
        
        
        <dd><a href="http://docs.locust.io/en/v0.7.2/changelog.html">v0.7.2</a></dd>
        
        
        
        <dd><a href="http://docs.locust.io/en/v0.7.1/changelog.html">v0.7.1</a></dd>
        
        
        
        <dd><a href="http://docs.locust.io/en/v0.7/changelog.html">v0.7</a></dd>
        
        
        
        <dd><a href="http://docs.locust.io/en/v0.6.2/changelog.html">v0.6.2</a></dd>
        
        
        
        <dd><a href="http://docs.locust.io/en/v0.6.1/changelog.html">v0.6.1</a></dd>
        
        
        
        <dd><a href="http://docs.locust.io/en/v0.6/changelog.html">v0.6</a></dd>
        
        
        
        <dd><a href="http://docs.locust.io/en/v0.5.1/changelog.html">v0.5.1</a></dd>
        
        
        
        <dd><a href="http://docs.locust.io/en/0.4/changelog.html">0.4</a></dd>
        
        
      </dl>
      
      

      
      
      <dl>
        <dt>Downloads</dt>
        
        <dd><a href="https://readthedocs.org/projects/locust/downloads/pdf/stable/">PDF</a></dd>
        
        <dd><a href="https://readthedocs.org/projects/locust/downloads/htmlzip/stable/">HTML</a></dd>
        
        <dd><a href="https://readthedocs.org/projects/locust/downloads/epub/stable/">Epub</a></dd>
        
      </dl>
      
      

      
      <dl>
        <!-- These are kept as relative links for internal installs that are http -->
        <dt>On Read the Docs</dt>
        <dd>
          <a href="https://readthedocs.org/projects/locust/">Project Home</a>
        </dd>
        <dd>
          <a href="https://readthedocs.org/projects/locust/builds/">Builds</a>
        </dd>
        <dd>
          <a href="https://readthedocs.org/projects/locust/downloads/">Downloads</a>
        </dd>
      </dl>
      

      

      
      <dl>
        <dt>On GitHub</dt>
        <dd>
          <a href="https://github.com/locustio/locust/blob/4bde2ca90f28bde649ff4ce2c86e36a6e6260856/docs/changelog.rst">View</a>
        </dd>
        
      </dl>
      
      

      
      <dl>
        <dt>Search</dt>
        <dd>
          <div style="padding: 6px;">
            <form id="flyout-search-form" class="wy-form" target="_blank" action="https://readthedocs.org/projects/locust/search/" method="get">
              <input type="text" name="q" placeholder="Search docs">
              </form>
          </div>
        </dd>
      </dl>
      



      <hr>
      
        <small>
          <span>Hosted by <a href="https://readthedocs.org/">Read the Docs</a></span>
          <span> · </span>
          <a href="https://docs.readthedocs.io/page/privacy-policy.html">Privacy Policy</a>
        </small>
      

      

</div>
</div>
  </div>



  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.9.0',
            LANGUAGE:'en',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="./Locust 0.9.0文档13_files/jquery-2.0.3.min.js"></script>
      <script type="text/javascript" src="./Locust 0.9.0文档13_files/jquery-migrate-1.2.1.min.js"></script>
      <script type="text/javascript" src="./Locust 0.9.0文档13_files/underscore.js"></script>
      <script type="text/javascript" src="./Locust 0.9.0文档13_files/doctools.js"></script>
      <script type="text/javascript" src="./Locust 0.9.0文档13_files/readthedocs-doc-embed.js"></script>

  

  <script type="text/javascript" src="./Locust 0.9.0文档13_files/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script><div id="goog-gt-tt" class="skiptranslate" dir="ltr"><div style="padding: 8px;"><div><div class="logo"><img src="./Locust 0.9.0文档13_files/translate_24dp.png" width="20" height="20" alt="Google 翻译"></div></div></div><div class="top" style="padding: 8px; float: left; width: 100%;"><h1 class="title gray">原文</h1></div><div class="middle" style="padding: 8px;"><div class="original-text"></div></div><div class="bottom" style="padding: 8px;"><div class="activity-links"><span class="activity-link">提供更好的翻译建议</span><span class="activity-link"></span></div><div class="started-activity-container"><hr style="color: #CCC; background-color: #CCC; height: 1px; border: none;"><div class="activity-root"></div></div></div><div class="status-message" style="display: none;"></div></div> 


<div class="goog-te-spinner-pos"><div class="goog-te-spinner-animation"><svg xmlns="http://www.w3.org/2000/svg" class="goog-te-spinner" width="96px" height="96px" viewBox="0 0 66 66"><circle class="goog-te-spinner-path" fill="none" stroke-width="6" stroke-linecap="round" cx="33" cy="33" r="30"></circle></svg></div></div></body></html>