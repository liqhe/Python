<!DOCTYPE html>
<!-- saved from url=(0061)https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/ -->
<html lang="zh-CN" class="mdzr-js mdzr-borderradius mdzr-boxshadow mdzr-cssanimations mdzr-svg translated-ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="ROBOTS" content="ALL">
    <meta name="MSSmartTagsPreventParsing" content="true">
    <meta name="Copyright" content="Django Software Foundation">
    <meta name="keywords" content="Python, Django, framework, open-source">
    <meta name="description" content="">

    
  
    
      
    
  
  <link rel="canonical" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/">
  
    
      
    
    <link rel="alternate" hreflang="el" href="https://docs.djangoproject.com/el/2.2/topics/db/queries/">
  
    
      
    
    <link rel="alternate" hreflang="en" href="https://docs.djangoproject.com/en/2.2/topics/db/queries/">
  
    
      
    
    <link rel="alternate" hreflang="es" href="https://docs.djangoproject.com/es/2.2/topics/db/queries/">
  
    
      
    
    <link rel="alternate" hreflang="fr" href="https://docs.djangoproject.com/fr/2.2/topics/db/queries/">
  
    
      
    
    <link rel="alternate" hreflang="id" href="https://docs.djangoproject.com/id/2.2/topics/db/queries/">
  
    
      
    
    <link rel="alternate" hreflang="ja" href="https://docs.djangoproject.com/ja/2.2/topics/db/queries/">
  
    
      
    
    <link rel="alternate" hreflang="ko" href="https://docs.djangoproject.com/ko/2.2/topics/db/queries/">
  
    
      
    
    <link rel="alternate" hreflang="pl" href="https://docs.djangoproject.com/pl/2.2/topics/db/queries/">
  
    
      
    
    <link rel="alternate" hreflang="pt-br" href="https://docs.djangoproject.com/pt-br/2.2/topics/db/queries/">
  
    
      
    
    <link rel="alternate" hreflang="zh-hans" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/">
  

  <link rel="search" type="application/opensearchdescription+xml" href="https://docs.djangoproject.com/zh-hans/2.2/search/description/" title="Django文档">

    <!-- Favicons -->
    <link rel="apple-touch-icon" href="https://static.djangoproject.com/img/icon-touch.e4872c4da341.png">
    <link rel="icon" sizes="192x192" href="https://static.djangoproject.com/img/icon-touch.e4872c4da341.png">
    <link rel="shortcut icon" href="https://static.djangoproject.com/img/favicon.6dbf28c0650e.ico">
    <meta name="msapplication-TileColor" content="#113228">
    <meta name="msapplication-TileImage" content="https://static.djangoproject.com/img/icon-tile.b01ac0ef9f67.png">

    <title>进行查询|  Django文档|  Django的</title>

    <link rel="stylesheet" href="./12进行查询_files/output.beb34528fd55.css">
    <script src="./12进行查询_files/webfontloader.e75218f5f090.js"></script>
    <link rel="stylesheet" href="./12进行查询_files/css"><script>
    WebFont.load({
      custom: {
        families: ['FontAwesome', 'Fira+Mono'],
      },
      google: {
        families: ['Roboto:400italic,700italic,300,700,400:latin'
        ]
      },
      classes: false,
      events: false,
      timeout: 1000
    });
    </script>
    <script src="./12进行查询_files/modernizr.3b36762e418a.js"></script>
    
  <script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="main.07884ebc4865" src="./12进行查询_files/main.07884ebc4865.js"></script><link type="text/css" rel="stylesheet" charset="UTF-8" href="./12进行查询_files/translateelement.css"><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="mod/mobile-menu" src="./12进行查询_files/mobile-menu.841726ee903a.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="mod/version-switcher" src="./12进行查询_files/version-switcher.c28bb83972bb.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="mod/search-key" src="./12进行查询_files/search-key.f3c0a6fcfedd.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="jquery" src="./12进行查询_files/jquery.min.87e69028f78d.js"></script></head>

  <body id="generic" class="">

    <div role="banner" id="top">
  <div class="container">
    <a class="logo" href="https://www.djangoproject.com/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Django的</font></font></a>
    <p class="meta"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">完美主义者的网络框架与截止日期。</font></font></p>
    <div class="menu-button"><i class="icon icon-reorder"></i><span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">菜单</font></font></span></div><div role="navigation" class="nav-menu-on">
      <ul>
        <li>
          <a href="https://www.djangoproject.com/start/overview/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">概观</font></font></a>
        </li>
        <li>
          <a href="https://www.djangoproject.com/download/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">下载</font></font></a>
        </li>
        <li class="active">
          <a href="https://docs.djangoproject.com/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文档</font></font></a>
        </li>
        <li>
          <a href="https://www.djangoproject.com/weblog/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新闻</font></font></a>
        </li>
        <li>
          <a href="https://www.djangoproject.com/community/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">社区</font></font></a>
        </li>
        <li>
          <a href="https://code.djangoproject.com/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">码</font></font></a>
        </li>
        <li>
          <a href="https://www.djangoproject.com/foundation/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">关于</font></font></a>
        </li>
        <li>
          <a href="https://www.djangoproject.com/fundraising/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">♥捐赠</font></font></a>
        </li>
      </ul>
    </div>
  </div>
</div>


    <div class="copy-banner">
      <div class="container">
        
  <h1><a href="https://docs.djangoproject.com/zh-hans/2.2/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文档</font></font></a></h1>

      </div>
    </div>
    <div id="billboard"></div>

    <div class="container sidebar-right">
      <div role="main">

        
          
        

        
<div id="version-switcher">
  <ul id="doc-languages" class="language-switcher">
  
  
  <li class="other">
    
      
    
    <a href="https://docs.djangoproject.com/el/2.2/topics/db/queries/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">埃尔</font></font></a>
  </li>
  
  
  
  <li class="other">
    
      
    
    <a href="https://docs.djangoproject.com/en/2.2/topics/db/queries/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">恩</font></font></a>
  </li>
  
  
  
  <li class="other">
    
      
    
    <a href="https://docs.djangoproject.com/es/2.2/topics/db/queries/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ES</font></font></a>
  </li>
  
  
  
  <li class="other">
    
      
    
    <a href="https://docs.djangoproject.com/fr/2.2/topics/db/queries/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FR</font></font></a>
  </li>
  
  
  
  <li class="other">
    
      
    
    <a href="https://docs.djangoproject.com/id/2.2/topics/db/queries/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ID</font></font></a>
  </li>
  
  
  
  <li class="other">
    
      
    
    <a href="https://docs.djangoproject.com/ja/2.2/topics/db/queries/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JA</font></font></a>
  </li>
  
  
  
  <li class="other">
    
      
    
    <a href="https://docs.djangoproject.com/ko/2.2/topics/db/queries/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KO</font></font></a>
  </li>
  
  
  
  <li class="other">
    
      
    
    <a href="https://docs.djangoproject.com/pl/2.2/topics/db/queries/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PL</font></font></a>
  </li>
  
  
  
  <li class="other">
    
      
    
    <a href="https://docs.djangoproject.com/pt-br/2.2/topics/db/queries/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PT-BR</font></font></a>
  </li>
  
  
  
  
    <li class="current" title="点击左侧的链接以切换到另一种语言。">
      <span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语言：</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zh-hans</font></font></strong></span>
    </li>
  </ul>

  
  <ul id="doc-versions" class="version-switcher">
    
    
    <li class="other">
      
        
      
      <a href="https://docs.djangoproject.com/zh-hans/2.0/topics/db/queries/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.0</font></font></a>
    </li>
    
    
    
    <li class="other">
      
        
      
      <a href="https://docs.djangoproject.com/zh-hans/2.1/topics/db/queries/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.1</font></font></a>
    </li>
    
    
    
    
    
    <li class="other">
      
        
      
      <a href="https://docs.djangoproject.com/zh-hans/dev/topics/db/queries/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">开发</font></font></a>
    </li>
    
    
    <li class="current" title="此文档是为Django 2.2编写的。点击左侧的链接查看其它版本">
       <span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文档版本：
          </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.2</font></font></strong>
       </span>
    </li>
  </ul>
</div>


<div id="docs-content">
<div class="section" id="s-making-queries">
<span id="making-queries"></span><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查询进行</font></font><a class="headerlink" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#making-queries" title="永久链接至标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h1>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一旦您创建了</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/models/"><span class="doc"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据模型</font></font></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，Django就会自动为您提供一个数据库抽象API，允许您创建，检索，更新和删除对象。</font><font style="vertical-align: inherit;">本文档介绍了如何使用此API。</font><font style="vertical-align: inherit;">有关所有各种模型查找选项的完整详细信息，</font><font style="vertical-align: inherit;">请参阅</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/"><span class="doc"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据模型参考</font></font></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在本指南（以及参考文献）中，我们将参考以下模型，其中包含Weblog应用程序：</font></font></p>
<div class="highlight-python notranslate" id="queryset-model-example"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>

<span class="k">class</span> <span class="nc">Blog</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">tagline</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>

<span class="k">class</span> <span class="nc">Author</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">email</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">EmailField</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>

<span class="k">class</span> <span class="nc">Entry</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">blog</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">Blog</span><span class="p">,</span> <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">CASCADE</span><span class="p">)</span>
    <span class="n">headline</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
    <span class="n">body_text</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">()</span>
    <span class="n">pub_date</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateField</span><span class="p">()</span>
    <span class="n">mod_date</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateField</span><span class="p">()</span>
    <span class="n">authors</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ManyToManyField</span><span class="p">(</span><span class="n">Author</span><span class="p">)</span>
    <span class="n">n_comments</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">()</span>
    <span class="n">n_pingbacks</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">()</span>
    <span class="n">rating</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">headline</span>
</pre></div>
</div>
<div class="section" id="s-creating-objects">
<span id="creating-objects"></span><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">创建对象</font></font><a class="headerlink" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#creating-objects" title="永久链接至标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h2>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为了在Python对象中表示数据库表数据，Django使用直观的系统：模型类表示数据库表，该类的实例表示数据库表中的特定记录。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要创建对象，请使用模型类的关键字参数对其进行实例化，然后调用</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/instances/#django.db.models.Model.save" title="django.db.models.Model.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以将其保存到数据库中。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">假设模型存在于文件中</font></font><code class="docutils literal notranslate"><span class="pre">mysite/blog/models.py</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，这是一个例子：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">blog.models</span> <span class="k">import</span> <span class="n">Blog</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">Blog</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">'Beatles Blog'</span><span class="p">,</span> <span class="n">tagline</span><span class="o">=</span><span class="s1">'All the latest Beatles news.'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这会</font></font><code class="docutils literal notranslate"><span class="pre">INSERT</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在幕后</font><font style="vertical-align: inherit;">执行</font><font style="vertical-align: inherit;">SQL语句。</font><font style="vertical-align: inherit;">在您明确调用之前，Django不会访问数据库</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/instances/#django.db.models.Model.save" title="django.db.models.Model.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/instances/#django.db.models.Model.save" title="django.db.models.Model.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法没有返回值。</font></font></p>
<div class="admonition seealso">
<p class="first admonition-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参见</font></font></p>
<p><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/instances/#django.db.models.Model.save" title="django.db.models.Model.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">采用了许多此处未描述的高级选项。</font><font style="vertical-align: inherit;">有关</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/instances/#django.db.models.Model.save" title="django.db.models.Model.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">完整的详细信息，</font><font style="vertical-align: inherit;">请参阅文档
 </font><font style="vertical-align: inherit;">。</font></font></p>
<p class="last"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要在一个步骤中创建和保存对象，请使用该
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet.create" title="django.db.models.query.QuerySet.create"><code class="xref py py-meth docutils literal notranslate"><span class="pre">create()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法。</font></font></p>
</div>
</div>
<div class="section" id="s-saving-changes-to-objects">
<span id="saving-changes-to-objects"></span><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">保存对象的更改</font></font><a class="headerlink" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#saving-changes-to-objects" title="永久链接至标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h2>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要保存对已存在于数据库中的对象的更改，请使用
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/instances/#django.db.models.Model.save" title="django.db.models.Model.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">给定</font><font style="vertical-align: inherit;">已保存到数据库</font><font style="vertical-align: inherit;">的</font></font><code class="docutils literal notranslate"><span class="pre">Blog</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实例</font></font><code class="docutils literal notranslate"><span class="pre">b5</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，此示例更改其名称并更新其在数据库中的记录：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b5</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">'New name'</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b5</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这会</font></font><code class="docutils literal notranslate"><span class="pre">UPDATE</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在幕后</font><font style="vertical-align: inherit;">执行</font><font style="vertical-align: inherit;">SQL语句。</font><font style="vertical-align: inherit;">在您明确调用之前，Django不会访问数据库</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/instances/#django.db.models.Model.save" title="django.db.models.Model.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
<div class="section" id="s-saving-foreignkey-and-manytomanyfield-fields">
<span id="saving-foreignkey-and-manytomanyfield-fields"></span><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">保存</font></font><code class="docutils literal notranslate"><span class="pre">ForeignKey</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="docutils literal notranslate"><span class="pre">ManyToManyField</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字段</font></font><a class="headerlink" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#saving-foreignkey-and-manytomanyfield-fields" title="永久链接至标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h3>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更新</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/fields/#django.db.models.ForeignKey" title="django.db.models.ForeignKey"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForeignKey</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字段的工作方式与保存普通字段的方式完全相同 - 只需将正确类型的对象分配给相关字段即可。</font><font style="vertical-align: inherit;">此示例更新</font><font style="vertical-align: inherit;">实例</font><font style="vertical-align: inherit;">的</font></font><code class="docutils literal notranslate"><span class="pre">blog</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性
 </font><font style="vertical-align: inherit;">，假设适当的实例</font><font style="vertical-align: inherit;">和
 </font><font style="vertical-align: inherit;">已保存到数据库（因此我们可以在下面检索它们）：</font></font><code class="docutils literal notranslate"><span class="pre">Entry</span></code><font style="vertical-align: inherit;"></font><code class="docutils literal notranslate"><span class="pre">entry</span></code><font style="vertical-align: inherit;"></font><code class="docutils literal notranslate"><span class="pre">Entry</span></code><font style="vertical-align: inherit;"></font><code class="docutils literal notranslate"><span class="pre">Blog</span></code><font style="vertical-align: inherit;"></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">blog.models</span> <span class="k">import</span> <span class="n">Blog</span><span class="p">,</span> <span class="n">Entry</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">entry</span> <span class="o">=</span> <span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cheese_blog</span> <span class="o">=</span> <span class="n">Blog</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">"Cheddar Talk"</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">entry</span><span class="o">.</span><span class="n">blog</span> <span class="o">=</span> <span class="n">cheese_blog</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">entry</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更新</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/fields/#django.db.models.ManyToManyField" title="django.db.models.ManyToManyField"><code class="xref py py-class docutils literal notranslate"><span class="pre">ManyToManyField</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">工作的方式略有不同 - 使用
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/relations/#django.db.models.fields.related.RelatedManager.add" title="django.db.models.fields.related.RelatedManager.add"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字段上的方法向关系添加记录。</font><font style="vertical-align: inherit;">此示例将</font></font><code class="docutils literal notranslate"><span class="pre">Author</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实例
 </font><font style="vertical-align: inherit;">添加</font></font><code class="docutils literal notranslate"><span class="pre">joe</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">到</font></font><code class="docutils literal notranslate"><span class="pre">entry</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对象：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">blog.models</span> <span class="k">import</span> <span class="n">Author</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">joe</span> <span class="o">=</span> <span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">"Joe"</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">entry</span><span class="o">.</span><span class="n">authors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">joe</span><span class="p">)</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/fields/#django.db.models.ManyToManyField" title="django.db.models.ManyToManyField"><code class="xref py py-class docutils literal notranslate"><span class="pre">ManyToManyField</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一次性</font><font style="vertical-align: inherit;">添加多个记录，</font><font style="vertical-align: inherit;">请在调用中包含多个参数
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/relations/#django.db.models.fields.related.RelatedManager.add" title="django.db.models.fields.related.RelatedManager.add"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，如下所示：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">john</span> <span class="o">=</span> <span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">"John"</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">paul</span> <span class="o">=</span> <span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">"Paul"</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">george</span> <span class="o">=</span> <span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">"George"</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ringo</span> <span class="o">=</span> <span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">"Ringo"</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">entry</span><span class="o">.</span><span class="n">authors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">john</span><span class="p">,</span> <span class="n">paul</span><span class="p">,</span> <span class="n">george</span><span class="p">,</span> <span class="n">ringo</span><span class="p">)</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果您尝试分配或添加错误类型的对象，Django会抱怨。</font></font></p>
</div>
</div>
<div class="section" id="s-retrieving-objects">
<span id="s-id1"></span><span id="retrieving-objects"></span><span id="id1"></span><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">检索对象</font></font><a class="headerlink" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#retrieving-objects" title="永久链接至标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h2>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要从数据库中检索对象，请</font><font style="vertical-align: inherit;">在模型类上</font><font style="vertical-align: inherit;">构建一个
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">via a
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/managers/#django.db.models.Manager" title="django.db.models.Manager"><code class="xref py py-class docutils literal notranslate"><span class="pre">Manager</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示数据库中的对象集合。</font><font style="vertical-align: inherit;">它可以有零个，一个或多个</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">过滤器</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">过滤器根据给定的参数缩小查询结果范围。</font><font style="vertical-align: inherit;">在SQL术语中，a
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">等同于</font></font><code class="docutils literal notranslate"><span class="pre">SELECT</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句，过滤器是限制子句，如</font></font><code class="docutils literal notranslate"><span class="pre">WHERE</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code class="docutils literal notranslate"><span class="pre">LIMIT</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">你可以</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用你的模型
 </font><font style="vertical-align: inherit;">获得</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/managers/#django.db.models.Manager" title="django.db.models.Manager"><code class="xref py py-class docutils literal notranslate"><span class="pre">Manager</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">每个模型至少有一个
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/managers/#django.db.models.Manager" title="django.db.models.Manager"><code class="xref py py-class docutils literal notranslate"><span class="pre">Manager</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/class/#django.db.models.Model.objects" title="django.db.models.Model.objects"><code class="xref py py-attr docutils literal notranslate"><span class="pre">objects</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认情况下</font><font style="vertical-align: inherit;">调用它
 </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">通过模型类直接访问它，如下所示：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Blog</span><span class="o">.</span><span class="n">objects</span>
<span class="go">&lt;django.db.models.manager.Manager object at ...&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">Blog</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">'Foo'</span><span class="p">,</span> <span class="n">tagline</span><span class="o">=</span><span class="s1">'Bar'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">objects</span>
<span class="go">Traceback:</span>
<span class="go">    ...</span>
<span class="go">AttributeError: "Manager isn't accessible via Blog instances."</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注解</font></font></p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">Managers</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 只能通过模型​​类而不是模型实例访问，以强制“表级”操作和“记录级”操作之间的分离。</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/managers/#django.db.models.Manager" title="django.db.models.Manager"><code class="xref py py-class docutils literal notranslate"><span class="pre">Manager</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font><code class="docutils literal notranslate"><span class="pre">QuerySets</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">模型</font><font style="vertical-align: inherit;">的主要来源</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">例如，</font></font><code class="docutils literal notranslate"><span class="pre">Blog.objects.all()</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含</font></font><code class="docutils literal notranslate"><span class="pre">Blog</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据库</font><font style="vertical-align: inherit;">中所有</font><font style="vertical-align: inherit;">对象的</font><font style="vertical-align: inherit;">a
 </font><font style="vertical-align: inherit;">。</font></font></p>
<div class="section" id="s-retrieving-all-objects">
<span id="retrieving-all-objects"></span><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">检索所有对象</font></font><a class="headerlink" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#retrieving-all-objects" title="永久链接至标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h3>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从表中检索对象的最简单方法是获取所有这些对象。</font><font style="vertical-align: inherit;">为此，请使用以下</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet.all" title="django.db.models.query.QuerySet.all"><code class="xref py py-meth docutils literal notranslate"><span class="pre">all()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/managers/#django.db.models.Manager" title="django.db.models.Manager"><code class="xref py py-class docutils literal notranslate"><span class="pre">Manager</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">all_entries</span> <span class="o">=</span> <span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet.all" title="django.db.models.query.QuerySet.all"><code class="xref py py-meth docutils literal notranslate"><span class="pre">all()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法返回
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据库中所有对象的一个​​。</font></font></p>
</div>
<div class="section" id="s-retrieving-specific-objects-with-filters">
<span id="retrieving-specific-objects-with-filters"></span><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用过滤器检索特定对象</font></font><a class="headerlink" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#retrieving-specific-objects-with-filters" title="永久链接至标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h3>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过返回
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet.all" title="django.db.models.query.QuerySet.all"><code class="xref py py-meth docutils literal notranslate"><span class="pre">all()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述数据库中的表中的所有对象。</font><font style="vertical-align: inherit;">但是，通常，您只需要选择整个对象集的子集。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要创建此类子集，请优化初始
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">添加过滤条件。</font><font style="vertical-align: inherit;">两种最常见的改进方法</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是：</font></font></p>
<dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">filter(**kwargs)</span></code></dt>
<dd><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含与给定查找参数匹配的</font><font style="vertical-align: inherit;">新</font><font style="vertical-align: inherit;">对象。</font></font></dd>
<dt><code class="docutils literal notranslate"><span class="pre">exclude(**kwargs)</span></code></dt>
<dd><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含</font><font style="vertical-align: inherit;">与给定查找参数</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">匹配的</font><font style="vertical-align: inherit;">新</font><font style="vertical-align: inherit;">对象</font><font style="vertical-align: inherit;">。</font></font></dd>
</dl>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查找参数（</font></font><code class="docutils literal notranslate"><span class="pre">**kwargs</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在上面的函数定义中）应采用</font><font style="vertical-align: inherit;">下面的</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#field-lookups"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字段查找</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中</font><font style="vertical-align: inherit;">描述的格式</font><font style="vertical-align: inherit;">。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例如，要获取</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2006年的博客条目，请使用</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet.filter" title="django.db.models.query.QuerySet.filter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">filter()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如下：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pub_date__year</span><span class="o">=</span><span class="mi">2006</span><span class="p">)</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用默认的manager类，它与以下内容相同：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pub_date__year</span><span class="o">=</span><span class="mi">2006</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="s-chaining-filters">
<span id="s-id2"></span><span id="chaining-filters"></span><span id="id2"></span><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">链接过滤器</font></font><a class="headerlink" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#chaining-filters" title="永久链接至标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h4>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">精炼a的结果</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">本身就是a
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，因此可以将精化链接在一起。</font><font style="vertical-align: inherit;">例如：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">headline__startswith</span><span class="o">=</span><span class="s1">'What'</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">exclude</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pub_date__gte</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pub_date__gte</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2005</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这将获取</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据库中所有条目</font><font style="vertical-align: inherit;">的首字母</font><font style="vertical-align: inherit;">，添加过滤器，然后是排除，然后是另一个过滤器。</font><font style="vertical-align: inherit;">最终结果是</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含标题以“What”开头的所有条目，这些条目在2005年1月30日和当天之间发布。</font></font></p>
</div>
<div class="section" id="s-filtered-querysets-are-unique">
<span id="s-id3"></span><span id="filtered-querysets-are-unique"></span><span id="id3"></span><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">过滤的</font></font><code class="docutils literal notranslate"><span class="pre">QuerySet</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s是独一无二的</font></font><a class="headerlink" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#filtered-querysets-are-unique" title="永久链接至标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h4>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">每当你精炼一个</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，你就会得到一个全新的</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，与以前没有任何关系</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">每个细化都会创建一个</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以存储，使用和重用</font><font style="vertical-align: inherit;">的独立且不同的细分</font><font style="vertical-align: inherit;">。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">举例：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q1</span> <span class="o">=</span> <span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">headline__startswith</span><span class="o">=</span><span class="s2">"What"</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q2</span> <span class="o">=</span> <span class="n">q1</span><span class="o">.</span><span class="n">exclude</span><span class="p">(</span><span class="n">pub_date__gte</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q3</span> <span class="o">=</span> <span class="n">q1</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pub_date__gte</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">())</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这三者</font></font><code class="docutils literal notranslate"><span class="pre">QuerySets</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是分开的。</font><font style="vertical-align: inherit;">第一个是</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含所有条目</font><font style="vertical-align: inherit;">的基础，
 </font><font style="vertical-align: inherit;">其中包含以“What”开头的标题。</font><font style="vertical-align: inherit;">第二个是第一个的子集，其他标准排除了</font></font><code class="docutils literal notranslate"><span class="pre">pub_date</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">今天或将来的记录。</font><font style="vertical-align: inherit;">第三个是第一个的子集，其他标准仅选择</font></font><code class="docutils literal notranslate"><span class="pre">pub_date</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当前或未来</font><font style="vertical-align: inherit;">的记录</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">initial </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font><code class="docutils literal notranslate"><span class="pre">q1</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）不受细化过程的影响。</font></font></p>
</div>
<div class="section" id="s-querysets-are-lazy">
<span id="s-id4"></span><span id="querysets-are-lazy"></span><span id="id4"></span><h4><code class="docutils literal notranslate"><span class="pre">QuerySet</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s很懒</font></font><a class="headerlink" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#querysets-are-lazy" title="永久链接至标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h4>
<p><code class="docutils literal notranslate"><span class="pre">QuerySets</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是懒惰的 - 创建一个
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不涉及任何数据库活动的行为。</font><font style="vertical-align: inherit;">可以叠加的滤光片，整天和Django将不实际运行查询，直到</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">被
 </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">评估</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">看看这个例子：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">headline__startswith</span><span class="o">=</span><span class="s2">"What"</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pub_date__lte</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">exclude</span><span class="p">(</span><span class="n">body_text__icontains</span><span class="o">=</span><span class="s2">"food"</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">虽然这看起来像三个数据库命中，但事实上它只在数据库中命中一次，在最后一行（</font></font><code class="docutils literal notranslate"><span class="pre">print(q)</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font><font style="vertical-align: inherit;">通常，在</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您“询问”它们之前，不会从数据库中获取</font><font style="vertical-align: inherit;">a的结果
 </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">执行此操作时，将
 </font><font style="vertical-align: inherit;">通过访问数据库</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">评估</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">有关何时进行评估的详细信息，请参阅
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#when-querysets-are-evaluated"><span class="std std-ref"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">评估QuerySet时</font></font></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</div>
</div>
<div class="section" id="s-retrieving-a-single-object-with-get">
<span id="s-retrieving-single-object-with-get"></span><span id="retrieving-a-single-object-with-get"></span><span id="retrieving-single-object-with-get"></span><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用</font><a class="headerlink" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#retrieving-a-single-object-with-get" title="永久链接至标题"><font style="vertical-align: inherit;">¶</font></a><font style="vertical-align: inherit;">检索单个对象</font></font><code class="docutils literal notranslate"><span class="pre">get()</span></code><a class="headerlink" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#retrieving-a-single-object-with-get" title="永久链接至标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h3>
<p><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet.filter" title="django.db.models.query.QuerySet.filter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">filter()</span></code></a><font style="vertical-align: inherit;"></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">即使只有一个对象与查询匹配，也</font><font style="vertical-align: inherit;">总会给你一个
 </font><font style="vertical-align: inherit;">- 在这种情况下，它将
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含一个元素。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果您知道只有一个对象与您的查询匹配，则可以使用</font><font style="vertical-align: inherit;">直接返回对象</font><font style="vertical-align: inherit;">的
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet.get" title="django.db.models.query.QuerySet.get"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/managers/#django.db.models.Manager" title="django.db.models.Manager"><code class="xref py py-class docutils literal notranslate"><span class="pre">Manager</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">one_entry</span> <span class="o">=</span> <span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您可以使用任何查询表达式
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet.get" title="django.db.models.query.QuerySet.get"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，就像使用
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet.filter" title="django.db.models.query.QuerySet.filter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">filter()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- 再次，请参阅</font><font style="vertical-align: inherit;">
下面的</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#field-lookups"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字段查找</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请注意，使用</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet.get" title="django.db.models.query.QuerySet.get"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和使用
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet.filter" title="django.db.models.query.QuerySet.filter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">filter()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">切片</font><font style="vertical-align: inherit;">之间存在差异
 </font></font><code class="docutils literal notranslate"><span class="pre">[0]</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果没有与查询匹配的结果，
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet.get" title="django.db.models.query.QuerySet.get"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则会引发</font></font><code class="docutils literal notranslate"><span class="pre">DoesNotExist</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
异常。</font><font style="vertical-align: inherit;">此异常是正在执行查询的模型类的属性 - 因此在上面的代码中，如果没有</font></font><code class="docutils literal notranslate"><span class="pre">Entry</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">主键为1的对象，Django将引发</font></font><code class="docutils literal notranslate"><span class="pre">Entry.DoesNotExist</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">同样，如果多个项目与</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet.get" title="django.db.models.query.QuerySet.get"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查询</font><font style="vertical-align: inherit;">匹配，Django会抱怨
 </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在这种情况下，它会引发
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/exceptions/#django.core.exceptions.MultipleObjectsReturned" title="django.core.exceptions.MultipleObjectsReturned"><code class="xref py py-exc docutils literal notranslate"><span class="pre">MultipleObjectsReturned</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，这也是模型类本身的属性。</font></font></p>
</div>
<div class="section" id="s-other-queryset-methods">
<span id="other-queryset-methods"></span><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">其他</font></font><code class="docutils literal notranslate"><span class="pre">QuerySet</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法</font></font><a class="headerlink" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#other-queryset-methods" title="永久链接至标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h3>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在大多数情况下，你会使用</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet.all" title="django.db.models.query.QuerySet.all"><code class="xref py py-meth docutils literal notranslate"><span class="pre">all()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet.get" title="django.db.models.query.QuerySet.get"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet.filter" title="django.db.models.query.QuerySet.filter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">filter()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet.exclude" title="django.db.models.query.QuerySet.exclude"><code class="xref py py-meth docutils literal notranslate"><span class="pre">exclude()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当你需要从数据库中查找对象。</font><font style="vertical-align: inherit;">然而，这远非一切; </font><font style="vertical-align: inherit;">有关所有各种</font><font style="vertical-align: inherit;">方法</font><font style="vertical-align: inherit;">的完整列表，</font><font style="vertical-align: inherit;">请参阅
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#queryset-api"><span class="std std-ref"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">QuerySet API参考</font></font></span></a><font style="vertical-align: inherit;"></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="section" id="s-limiting-querysets">
<span id="s-id5"></span><span id="limiting-querysets"></span><span id="id5"></span><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">限制</font></font><code class="docutils literal notranslate"><span class="pre">QuerySet</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">小号</font></font><a class="headerlink" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#limiting-querysets" title="永久链接至标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h3>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用Python的数组切片语法的子集将您限制
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为一定数量的结果。</font><font style="vertical-align: inherit;">这相当于SQL </font></font><code class="docutils literal notranslate"><span class="pre">LIMIT</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="docutils literal notranslate"><span class="pre">OFFSET</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例如，这将返回前5个对象（</font><font style="vertical-align: inherit;">）：</font></font><code class="docutils literal notranslate"><span class="pre">LIMIT</span> <span class="pre">5</span></code><font style="vertical-align: inherit;"></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这将返回第六个到第十个对象（</font><font style="vertical-align: inherit;">）：</font></font><code class="docutils literal notranslate"><span class="pre">OFFSET</span> <span class="pre">5</span> <span class="pre">LIMIT</span> <span class="pre">5</span></code><font style="vertical-align: inherit;"></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()[</span><span class="mi">5</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"></font><code class="docutils literal notranslate"><span class="pre">Entry.objects.all()[-1]</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不支持</font><font style="vertical-align: inherit;">负索引（即</font><font style="vertical-align: inherit;">）。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通常，切片</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回一个新的
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- 它不会评估查询。</font><font style="vertical-align: inherit;">如果使用Python切片语法的“step”参数，则会出现异常。</font><font style="vertical-align: inherit;">例如，这实际上会执行查询以返回</font><font style="vertical-align: inherit;">前10 </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">个</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中每个</font><em><font style="vertical-align: inherit;">第二个</font></em><font style="vertical-align: inherit;">对象的</font><font style="vertical-align: inherit;">列表</font><font style="vertical-align: inherit;">：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()[:</span><span class="mi">10</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">禁止对切片查询集进行进一步过滤或排序，因为这可能会产生模糊性。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要检索</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">单个</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对象而不是列表（例如</font><font style="vertical-align: inherit;">），请使用简单索引而不是切片。</font><font style="vertical-align: inherit;">例如，</font><font style="vertical-align: inherit;">在按标题按字母顺序排序条目之后</font><font style="vertical-align: inherit;">，这将返回</font><font style="vertical-align: inherit;">数据库中</font><font style="vertical-align: inherit;">的第一个</font><font style="vertical-align: inherit;">：</font></font><code class="docutils literal notranslate"><span class="pre">SELECT</span> <span class="pre">foo</span> <span class="pre">FROM</span> <span class="pre">bar</span> <span class="pre">LIMIT</span> <span class="pre">1</span></code><font style="vertical-align: inherit;"></font><code class="docutils literal notranslate"><span class="pre">Entry</span></code><font style="vertical-align: inherit;"></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s1">'headline'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这大致相当于：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s1">'headline'</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">但请注意，</font><font style="vertical-align: inherit;">如果没有对象符合给定条件</font><font style="vertical-align: inherit;">，则第一个将提升，</font></font><code class="docutils literal notranslate"><span class="pre">IndexError</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">而第二个将提高</font></font><code class="docutils literal notranslate"><span class="pre">DoesNotExist</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">有关</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet.get" title="django.db.models.query.QuerySet.get"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">详细信息，</font><font style="vertical-align: inherit;">请参阅
</font></font></p>
</div>
<div class="section" id="s-field-lookups">
<span id="s-field-lookups-intro"></span><span id="field-lookups"></span><span id="field-lookups-intro"></span><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字段查找</font></font><a class="headerlink" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#field-lookups" title="永久链接至标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h3>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字段查找是指定SQL </font></font><code class="docutils literal notranslate"><span class="pre">WHERE</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句的内容的方式。</font><font style="vertical-align: inherit;">它们被指定为</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
方法的</font><font style="vertical-align: inherit;">关键字参数</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet.filter" title="django.db.models.query.QuerySet.filter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">filter()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet.exclude" title="django.db.models.query.QuerySet.exclude"><code class="xref py py-meth docutils literal notranslate"><span class="pre">exclude()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并且
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet.get" title="django.db.models.query.QuerySet.get"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">基本查找关键字参数采用表单</font></font><code class="docutils literal notranslate"><span class="pre">field__lookuptype=value</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">（这是一个双重下划线）。</font><font style="vertical-align: inherit;">例如：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pub_date__lte</span><span class="o">=</span><span class="s1">'2006-01-01'</span><span class="p">)</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将（粗略地）翻译成以下SQL：</font></font></p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">blog_entry</span> <span class="k">WHERE</span> <span class="n">pub_date</span> <span class="o">&lt;=</span> <span class="s1">'2006-01-01'</span><span class="p">;</span>
</pre></div>
</div>
<div class="admonition-how-this-is-possible admonition">
<p class="first admonition-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这怎么可能</font></font></p>
<p class="last"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Python能够定义接受任意名称 - 值参数的函数，这些参数的名称和值在运行时进行计算。</font><font style="vertical-align: inherit;">有关更多信息，请参阅</font><font style="vertical-align: inherit;">官方Python教程中的</font></font><a class="reference external" href="https://docs.python.org/3/tutorial/controlflow.html#tut-keywordargs" title="（在Python v3.7中）"><span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">关键字参数</font></font></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查找中指定的字段必须是模型字段的名称。</font><font style="vertical-align: inherit;">但是有一个例外，如果</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/fields/#django.db.models.ForeignKey" title="django.db.models.ForeignKey"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForeignKey</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">你可以指定后缀的字段名称</font></font><code class="docutils literal notranslate"><span class="pre">_id</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在这种情况下，value参数应包含外部模型主键的原始值。</font><font style="vertical-align: inherit;">例如：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">blog_id</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果传递无效的关键字参数，则会引发查找函数
 </font></font><code class="docutils literal notranslate"><span class="pre">TypeError</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据库API支持大约24种查找类型; </font><font style="vertical-align: inherit;">可以在</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#field-lookups"><span class="std std-ref"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字段查找参考中</font></font></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">找到完整的</font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#field-lookups"><span class="std std-ref"><font style="vertical-align: inherit;">参考</font></span></a><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">为了让您了解可用的内容，这里有一些您可能会使用的更常见的查找：</font></font></p>
<dl class="docutils">
<dt><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#std:fieldlookup-exact"><code class="xref std std-lookup docutils literal notranslate"><span class="pre">exact</span></code></a></dt>
<dd><p class="first"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“精确”匹配。</font><font style="vertical-align: inherit;">例如：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">headline__exact</span><span class="o">=</span><span class="s2">"Cat bites dog"</span><span class="p">)</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将沿这些行生成SQL：</font></font></p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="p">...</span> <span class="k">WHERE</span> <span class="n">headline</span> <span class="o">=</span> <span class="s1">'Cat bites dog'</span><span class="p">;</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果您不提供查找类型 - 也就是说，如果您的关键字参数不包含双下划线 - 则假定查找类型为
 </font></font><code class="docutils literal notranslate"><span class="pre">exact</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例如，以下两个语句是等效的：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Blog</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">id__exact</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>  <span class="c1"># Explicit form</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Blog</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>         <span class="c1"># __exact is implied</span>
</pre></div>
</div>
<p class="last"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这是为了方便，因为</font></font><code class="docutils literal notranslate"><span class="pre">exact</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查找是常见的情况。</font></font></p>
</dd>
<dt><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#std:fieldlookup-iexact"><code class="xref std std-lookup docutils literal notranslate"><span class="pre">iexact</span></code></a></dt>
<dd><p class="first"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不区分大小写的匹配项。</font><font style="vertical-align: inherit;">所以，查询：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Blog</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name__iexact</span><span class="o">=</span><span class="s2">"beatles blog"</span><span class="p">)</span>
</pre></div>
</div>
<p class="last"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">会匹配</font></font><code class="docutils literal notranslate"><span class="pre">Blog</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标题</font><font style="vertical-align: inherit;">，</font><font style="vertical-align: inherit;">甚至是</font><font style="vertical-align: inherit;">。</font></font><code class="docutils literal notranslate"><span class="pre">"Beatles</span> <span class="pre">Blog"</span></code><font style="vertical-align: inherit;"></font><code class="docutils literal notranslate"><span class="pre">"beatles</span> <span class="pre">blog"</span></code><font style="vertical-align: inherit;"></font><code class="docutils literal notranslate"><span class="pre">"BeAtlES</span> <span class="pre">blOG"</span></code><font style="vertical-align: inherit;"></font></p>
</dd>
<dt><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#std:fieldlookup-contains"><code class="xref std std-lookup docutils literal notranslate"><span class="pre">contains</span></code></a></dt>
<dd><p class="first"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">区分大小写的遏制测试。</font><font style="vertical-align: inherit;">例如：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">headline__contains</span><span class="o">=</span><span class="s1">'Lennon'</span><span class="p">)</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">大致翻译为这个SQL：</font></font></p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="p">...</span> <span class="k">WHERE</span> <span class="n">headline</span> <span class="k">LIKE</span> <span class="s1">'%Lennon%'</span><span class="p">;</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请注意，这将与标题匹配，</font><font style="vertical-align: inherit;">但不
 </font><font style="vertical-align: inherit;">匹配</font><font style="vertical-align: inherit;">。</font></font><code class="docutils literal notranslate"><span class="pre">'Today</span> <span class="pre">Lennon</span> <span class="pre">honored'</span></code><font style="vertical-align: inherit;"></font><code class="docutils literal notranslate"><span class="pre">'today</span> <span class="pre">lennon</span> <span class="pre">honored'</span></code><font style="vertical-align: inherit;"></font></p>
<p class="last"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">还有一个不区分大小写的版本</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#std:fieldlookup-icontains"><code class="xref std std-lookup docutils literal notranslate"><span class="pre">icontains</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</dd>
<dt><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#std:fieldlookup-startswith"><code class="xref std std-lookup docutils literal notranslate"><span class="pre">startswith</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">， </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#std:fieldlookup-endswith"><code class="xref std std-lookup docutils literal notranslate"><span class="pre">endswith</span></code></a></dt>
<dd><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">分别以搜索开始和结束。</font><font style="vertical-align: inherit;">还有一些不区分大小写的版本叫做</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#std:fieldlookup-istartswith"><code class="xref std std-lookup docutils literal notranslate"><span class="pre">istartswith</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#std:fieldlookup-iendswith"><code class="xref std std-lookup docutils literal notranslate"><span class="pre">iendswith</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></dd>
</dl>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">再次，这只是划伤表面。</font><font style="vertical-align: inherit;">可以在</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#field-lookups"><span class="std std-ref"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字段查找参考中</font></font></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">找到完整的
 </font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#field-lookups"><span class="std std-ref"><font style="vertical-align: inherit;">参考</font></span></a><font style="vertical-align: inherit;">。</font></font></p>
</div>
<div class="section" id="s-lookups-that-span-relationships">
<span id="s-id6"></span><span id="lookups-that-span-relationships"></span><span id="id6"></span><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">跨越关系的查找</font></font><a class="headerlink" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#lookups-that-span-relationships" title="永久链接至标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h3>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Django提供了一种强大而直观的方式来“跟踪”查找中的关系</font></font><code class="docutils literal notranslate"><span class="pre">JOIN</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，在后台自动为您处理</font><font style="vertical-align: inherit;">SQL </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">要跨越关系，只需使用跨模型的相关字段的字段名称，用双下划线分隔，直到到达所需的字段。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这个例子检索所有</font></font><code class="docutils literal notranslate"><span class="pre">Entry</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与对象</font></font><code class="docutils literal notranslate"><span class="pre">Blog</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，其</font></font><code class="docutils literal notranslate"><span class="pre">name</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
为</font><font style="vertical-align: inherit;">：</font></font><code class="docutils literal notranslate"><span class="pre">'Beatles</span> <span class="pre">Blog'</span></code><font style="vertical-align: inherit;"></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">blog__name</span><span class="o">=</span><span class="s1">'Beatles Blog'</span><span class="p">)</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这个跨度可以像你想的那样深。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">它也可以倒退。</font><font style="vertical-align: inherit;">要引用“反向”关系，只需使用模型的小写名称。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这个例子检索所有</font></font><code class="docutils literal notranslate"><span class="pre">Blog</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">具有至少一个对象</font></font><code class="docutils literal notranslate"><span class="pre">Entry</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
，其</font></font><code class="docutils literal notranslate"><span class="pre">headline</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含</font></font><code class="docutils literal notranslate"><span class="pre">'Lennon'</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Blog</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">entry__headline__contains</span><span class="o">=</span><span class="s1">'Lennon'</span><span class="p">)</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果您要跨多个关系进行过滤，并且其中一个中间模型没有满足过滤条件的值，Django会将其视为空（所有值都是</font></font><code class="docutils literal notranslate"><span class="pre">NULL</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">），但有效，对象存在。</font><font style="vertical-align: inherit;">所有这些意味着不会引发任何错误。</font><font style="vertical-align: inherit;">例如，在此过滤器中：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Blog</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">entry__authors__name</span><span class="o">=</span><span class="s1">'Lennon'</span><span class="p">)</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（如果存在相关</font></font><code class="docutils literal notranslate"><span class="pre">Author</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">模型），如果没有</font></font><code class="docutils literal notranslate"><span class="pre">author</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
与条目相关联，则将其视为没有</font></font><code class="docutils literal notranslate"><span class="pre">name</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
附加，而不是因为缺失而引发错误</font></font><code class="docutils literal notranslate"><span class="pre">author</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">通常这正是你想要发生的事情。</font><font style="vertical-align: inherit;">唯一可能令人困惑的情况是你正在使用它</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#std:fieldlookup-isnull"><code class="xref std std-lookup docutils literal notranslate"><span class="pre">isnull</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">从而：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Blog</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">entry__authors__name__isnull</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将返回</font></font><code class="docutils literal notranslate"><span class="pre">Blog</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有一个空的对象</font></font><code class="docutils literal notranslate"><span class="pre">name</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上</font></font><code class="docutils literal notranslate"><span class="pre">author</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，以及那些具有空</font></font><code class="docutils literal notranslate"><span class="pre">author</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的</font></font><code class="docutils literal notranslate"><span class="pre">entry</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果你不想要那些后面的对象，你可以写：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Blog</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">entry__authors__isnull</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">entry__authors__name__isnull</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="s-spanning-multi-valued-relationships">
<span id="spanning-multi-valued-relationships"></span><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">跨越多值关系</font></font><a class="headerlink" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#spanning-multi-valued-relationships" title="永久链接至标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h4>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当您基于a </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/fields/#django.db.models.ManyToManyField" title="django.db.models.ManyToManyField"><code class="xref py py-class docutils literal notranslate"><span class="pre">ManyToManyField</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或反向
 </font><font style="vertical-align: inherit;">过滤对象时
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/fields/#django.db.models.ForeignKey" title="django.db.models.ForeignKey"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForeignKey</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，您可能会对两种不同类型的过滤器感兴趣。请考虑</font></font><code class="docutils literal notranslate"><span class="pre">Blog</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ </font></font><code class="docutils literal notranslate"><span class="pre">Entry</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">relationship（</font></font><code class="docutils literal notranslate"><span class="pre">Blog</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为</font></font><code class="docutils literal notranslate"><span class="pre">Entry</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一对多关系）。</font><font style="vertical-align: inherit;">我们可能有兴趣找到一个博客，其条目</font><font style="vertical-align: inherit;">中标题为</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“列侬”</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并于2008年出版。或者我们可能希望找到</font><font style="vertical-align: inherit;">标题中</font><font style="vertical-align: inherit;">带有</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“列侬”</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">条目的博客
 </font><font style="vertical-align: inherit;">以及条目由于有多个条目与单个关联</font></font><code class="docutils literal notranslate"><span class="pre">Blog</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，因此这些查询都是可能的，并且在某些情况下是有意义的。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">同样的情况出现了
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/fields/#django.db.models.ManyToManyField" title="django.db.models.ManyToManyField"><code class="xref py py-class docutils literal notranslate"><span class="pre">ManyToManyField</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">例如，如果a </font></font><code class="docutils literal notranslate"><span class="pre">Entry</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有一个
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/fields/#django.db.models.ManyToManyField" title="django.db.models.ManyToManyField"><code class="xref py py-class docutils literal notranslate"><span class="pre">ManyToManyField</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">被叫</font></font><code class="docutils literal notranslate"><span class="pre">tags</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，我们可能想要找到链接到名为</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“music”</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“bands”</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的标签的条目，或者我们可能想要一个包含名称为</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“music”</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">且状态为</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“public”</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的标签的条目</font><font style="vertical-align: inherit;">。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为了处理这两种情况，Django有一种一致的处理
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet.filter" title="django.db.models.query.QuerySet.filter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">filter()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用方式。</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet.filter" title="django.db.models.query.QuerySet.filter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">filter()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">同时应用</font><font style="vertical-align: inherit;">单个</font><font style="vertical-align: inherit;">呼叫中的所有内容以过滤掉符合所有这些要求的项目。</font><font style="vertical-align: inherit;">连续
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet.filter" title="django.db.models.query.QuerySet.filter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">filter()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用进一步限制了对象集，但对于多值关系，它们适用于链接到主模型的任何对象，而不一定是先前</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet.filter" title="django.db.models.query.QuerySet.filter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">filter()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用</font><font style="vertical-align: inherit;">选择的那些对象</font><font style="vertical-align: inherit;">。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这可能听起来有点令人困惑，所以希望一个例子可以澄清。</font><font style="vertical-align: inherit;">要选择所有包含</font><font style="vertical-align: inherit;">标题</font><font style="vertical-align: inherit;">中包含</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“Lennon”</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">且2008年发布的</font><font style="vertical-align: inherit;">条目的博客</font><font style="vertical-align: inherit;">（满足这两个条件的相同条目），我们会写：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Blog</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">entry__headline__contains</span><span class="o">=</span><span class="s1">'Lennon'</span><span class="p">,</span> <span class="n">entry__pub_date__year</span><span class="o">=</span><span class="mi">2008</span><span class="p">)</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要选择</font><font style="vertical-align: inherit;">标题
 </font><font style="vertical-align: inherit;">中包含</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“Lennon”</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">条目的所有博客</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以及</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 2008年发布的条目，我们会写：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Blog</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">entry__headline__contains</span><span class="o">=</span><span class="s1">'Lennon'</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">entry__pub_date__year</span><span class="o">=</span><span class="mi">2008</span><span class="p">)</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">假设只有一个博客的两个条目都包含</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“Lennon”</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和2008年的条目，但是2008年的条目都没有包含</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“Lennon”</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">第一个查询不会返回任何博客，但第二个查询将返回该博客。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在第二个示例中，第一个过滤器将查询集限制为链接到</font><font style="vertical-align: inherit;">标题中</font><font style="vertical-align: inherit;">带有</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“Lennon”的</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">条目的所有博客</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">第二个过滤器将博客集</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">进一步</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">限制</font><font style="vertical-align: inherit;">为也链接到2008年发布的条目</font><font style="vertical-align: inherit;">的博客</font><font style="vertical-align: inherit;">。第二个过滤器选择的条目可能与第一个过滤器中的条目相同或不同。</font><font style="vertical-align: inherit;">我们</font></font><code class="docutils literal notranslate"><span class="pre">Blog</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用每个过滤器语句</font><font style="vertical-align: inherit;">过滤
 </font><font style="vertical-align: inherit;">项目，而不是</font></font><code class="docutils literal notranslate"><span class="pre">Entry</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">项目。</font></font></p>
<div class="admonition note">
<p class="first admonition-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注解</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如上所述</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet.filter" title="django.db.models.query.QuerySet.filter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">filter()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，跨越多值关系的查询</font><font style="vertical-align: inherit;">的行为</font><font style="vertical-align: inherit;">不是等效实现的</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet.exclude" title="django.db.models.query.QuerySet.exclude"><code class="xref py py-meth docutils literal notranslate"><span class="pre">exclude()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">相反，单个</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet.exclude" title="django.db.models.query.QuerySet.exclude"><code class="xref py py-meth docutils literal notranslate"><span class="pre">exclude()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
调用中</font><font style="vertical-align: inherit;">的条件</font><font style="vertical-align: inherit;">不一定是指同一个项目。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例如，下面的查询将排除包含博客</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">都</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
与条目</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“侬”</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的标题</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，并</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在2008年出版的条目：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Blog</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">exclude</span><span class="p">(</span>
    <span class="n">entry__headline__contains</span><span class="o">=</span><span class="s1">'Lennon'</span><span class="p">,</span>
    <span class="n">entry__pub_date__year</span><span class="o">=</span><span class="mi">2008</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">但是，与使用时的行为不同
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet.filter" title="django.db.models.query.QuerySet.filter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">filter()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，这不会限制基于满足这两个条件的条目的博客。</font><font style="vertical-align: inherit;">为了做到这一点，即选择所有不包含</font><font style="vertical-align: inherit;">
2008年</font><font style="vertical-align: inherit;">发布的</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“Lennon”</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">条目的博客</font><font style="vertical-align: inherit;">，您需要进行两次查询：</font></font></p>
<div class="last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Blog</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">exclude</span><span class="p">(</span>
    <span class="n">entry__in</span><span class="o">=</span><span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">headline__contains</span><span class="o">=</span><span class="s1">'Lennon'</span><span class="p">,</span>
        <span class="n">pub_date__year</span><span class="o">=</span><span class="mi">2008</span><span class="p">,</span>
    <span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="s-filters-can-reference-fields-on-the-model">
<span id="s-using-f-expressions-in-filters"></span><span id="filters-can-reference-fields-on-the-model"></span><span id="using-f-expressions-in-filters"></span><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">过滤器可以引用模型上的字段</font></font><a class="headerlink" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#filters-can-reference-fields-on-the-model" title="永久链接至标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h3>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在到目前为止给出的例子中，我们构造了过滤器，用于比较模型字段的值和常量。</font><font style="vertical-align: inherit;">但是，如果要将模型字段的值与同一模型上的另一个字段进行比较，该怎么办？</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Django </font><font style="vertical-align: inherit;">允许进行这样的比较。</font><font style="vertical-align: inherit;">作为查询中模型字段的引用的</font><font style="vertical-align: inherit;">实例</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">然后，可以在查询过滤器中使用这些引用来比较同一模型实例上的两个不同字段的值。</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/expressions/#django.db.models.F" title="django.db.models.F"><code class="xref py py-class docutils literal notranslate"><span class="pre">F</span> <span class="pre">expressions</span></code></a><font style="vertical-align: inherit;"></font><code class="docutils literal notranslate"><span class="pre">F()</span></code><font style="vertical-align: inherit;"></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例如，要查找包含比pingback更多注释的所有博客条目的列表，我们构造一个</font></font><code class="docutils literal notranslate"><span class="pre">F()</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对象来引用pingback计数，并</font></font><code class="docutils literal notranslate"><span class="pre">F()</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在查询中</font><font style="vertical-align: inherit;">使用该</font><font style="vertical-align: inherit;">对象：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.db.models</span> <span class="k">import</span> <span class="n">F</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">n_comments__gt</span><span class="o">=</span><span class="n">F</span><span class="p">(</span><span class="s1">'n_pingbacks'</span><span class="p">))</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Django支持对象使用加法，减法，乘法，除法，模运算和幂运算</font></font><code class="docutils literal notranslate"><span class="pre">F()</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，包括常量和其他</font></font><code class="docutils literal notranslate"><span class="pre">F()</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对象。</font><font style="vertical-align: inherit;">要查找所有博客条目的</font><font style="vertical-align: inherit;">评论数量是pingback的</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">两倍</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以上
 </font><font style="vertical-align: inherit;">，我们会修改查询：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">n_comments__gt</span><span class="o">=</span><span class="n">F</span><span class="p">(</span><span class="s1">'n_pingbacks'</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要查找条目评级小于pingback计数和评论计数总和的所有条目，我们将发出查询：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">rating__lt</span><span class="o">=</span><span class="n">F</span><span class="p">(</span><span class="s1">'n_comments'</span><span class="p">)</span> <span class="o">+</span> <span class="n">F</span><span class="p">(</span><span class="s1">'n_pingbacks'</span><span class="p">))</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您还可以使用双下划线表示法来跨越</font></font><code class="docutils literal notranslate"><span class="pre">F()</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对象中的</font><font style="vertical-align: inherit;">关系</font><font style="vertical-align: inherit;">。</font></font><code class="docutils literal notranslate"><span class="pre">F()</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">具有双下划线</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">对象将引入访问相关对象所需的任何连接。</font><font style="vertical-align: inherit;">例如，要检索作者姓名与博客名称相同的所有条目，我们可以发出查询：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">authors__name</span><span class="o">=</span><span class="n">F</span><span class="p">(</span><span class="s1">'blog__name'</span><span class="p">))</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对于日期和日期/时间字段，您可以添加或减去
 </font></font><a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta" title="（在Python v3.7中）"><code class="xref py py-class docutils literal notranslate"><span class="pre">timedelta</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对象。</font><font style="vertical-align: inherit;">以下内容将返回在发布后超过3天内修改的所有条目：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datetime</span> <span class="k">import</span> <span class="n">timedelta</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">mod_date__gt</span><span class="o">=</span><span class="n">F</span><span class="p">(</span><span class="s1">'pub_date'</span><span class="p">)</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该</font></font><code class="docutils literal notranslate"><span class="pre">F()</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对象通过支持位运算</font></font><code class="docutils literal notranslate"><span class="pre">.bitand()</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="docutils literal notranslate"><span class="pre">.bitor()</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
 </font></font><code class="docutils literal notranslate"><span class="pre">.bitrightshift()</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，和</font></font><code class="docutils literal notranslate"><span class="pre">.bitleftshift()</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">例如：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="p">(</span><span class="s1">'somefield'</span><span class="p">)</span><span class="o">.</span><span class="n">bitand</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="s-the-pk-lookup-shortcut">
<span id="the-pk-lookup-shortcut"></span><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在</font></font><code class="docutils literal notranslate"><span class="pre">pk</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查找快捷方式</font></font><a class="headerlink" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#the-pk-lookup-shortcut" title="永久链接至标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h3>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为方便起见，Django提供了一个</font></font><code class="docutils literal notranslate"><span class="pre">pk</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查找快捷方式，代表“主键”。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在示例</font></font><code class="docutils literal notranslate"><span class="pre">Blog</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">模型中，主键是</font></font><code class="docutils literal notranslate"><span class="pre">id</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字段，因此这三个语句是等效的：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Blog</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">id__exact</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span> <span class="c1"># Explicit form</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Blog</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span> <span class="c1"># __exact is implied</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Blog</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span> <span class="c1"># pk implies id__exact</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font></font><code class="docutils literal notranslate"><span class="pre">pk</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不仅限于</font></font><code class="docutils literal notranslate"><span class="pre">__exact</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查询 - 可以组合任何查询术语以</font></font><code class="docutils literal notranslate"><span class="pre">pk</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对模型的主键执行查询：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get blogs entries with id 1, 4 and 7</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Blog</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk__in</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>

<span class="c1"># Get all blog entries with id &gt; 14</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Blog</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pk__gt</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">pk</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查找也适用于连接。</font><font style="vertical-align: inherit;">例如，这三个陈述是等价的：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">blog__id__exact</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># Explicit form</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">blog__id</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>        <span class="c1"># __exact is implied</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">blog__pk</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>        <span class="c1"># __pk implies __id__exact</span>
</pre></div>
</div>
</div>
<div class="section" id="s-escaping-percent-signs-and-underscores-in-like-statements">
<span id="escaping-percent-signs-and-underscores-in-like-statements"></span><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在</font></font><code class="docutils literal notranslate"><span class="pre">LIKE</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句中</font><font style="vertical-align: inherit;">转义百分号和下划线</font></font><a class="headerlink" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#escaping-percent-signs-and-underscores-in-like-statements" title="永久链接至标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h3>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">现场查找那等同于</font></font><code class="docutils literal notranslate"><span class="pre">LIKE</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQL语句（</font></font><code class="docutils literal notranslate"><span class="pre">iexact</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
 </font></font><code class="docutils literal notranslate"><span class="pre">contains</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="docutils literal notranslate"><span class="pre">icontains</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="docutils literal notranslate"><span class="pre">startswith</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="docutils literal notranslate"><span class="pre">istartswith</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="docutils literal notranslate"><span class="pre">endswith</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
和</font></font><code class="docutils literal notranslate"><span class="pre">iendswith</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）将自动逃生使用的两个特殊字符
 </font></font><code class="docutils literal notranslate"><span class="pre">LIKE</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的语句-百分号和下划线。</font><font style="vertical-align: inherit;">（在一个</font></font><code class="docutils literal notranslate"><span class="pre">LIKE</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
语句中，百分号表示多字符通配符，下划线表示单字符通配符。）</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这意味着事情应该直观地工作，因此抽象不会泄漏。</font><font style="vertical-align: inherit;">例如，要检索包含百分号的所有条目，只需将百分号用作任何其他字符：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">headline__contains</span><span class="o">=</span><span class="s1">'%'</span><span class="p">)</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Django负责为你报价; </font><font style="vertical-align: inherit;">生成的SQL看起来像这样：</font></font></p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="p">...</span> <span class="k">WHERE</span> <span class="n">headline</span> <span class="k">LIKE</span> <span class="s1">'%\%%'</span><span class="p">;</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">下划线也是如此。</font><font style="vertical-align: inherit;">百分号和下划线都是透明处理的。</font></font></p>
</div>
<div class="section" id="s-caching-and-querysets">
<span id="s-id7"></span><span id="caching-and-querysets"></span><span id="id7"></span><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">缓存和</font></font><code class="docutils literal notranslate"><span class="pre">QuerySet</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">小号</font></font><a class="headerlink" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#caching-and-querysets" title="永久链接至标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h3>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">每个都</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含一个缓存，以最小化数据库访 </font><font style="vertical-align: inherit;">了解它的工作原理将允许您编写最有效的代码。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在新创建</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的缓存中，缓存为空。</font><font style="vertical-align: inherit;">第一次a </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">被评估 - 因此，数据库查询发生 -  Django将查询结果保存在</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">缓存中并返回已明确请求的结果（例如，下一个元素，如果
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">正在迭代）。</font><font style="vertical-align: inherit;">随后对</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重用缓存结果的</font><font style="vertical-align: inherit;">评估</font><font style="vertical-align: inherit;">。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">记住这种缓存行为，因为如果你没有</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">正确</font><font style="vertical-align: inherit;">使用你的</font><font style="vertical-align: inherit;">s </font><font style="vertical-align: inherit;">，它可能会咬你</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">例如，以下内容将创建两个</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s，对它们进行评估，然后抛弃它们：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">([</span><span class="n">e</span><span class="o">.</span><span class="n">headline</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">([</span><span class="n">e</span><span class="o">.</span><span class="n">pub_date</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()])</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这意味着相同的数据库查询将执行两次，从而有效地使数据库负载翻倍。</font><font style="vertical-align: inherit;">此外，两个列表可能不包含相同的数据库记录，因为</font></font><code class="docutils literal notranslate"><span class="pre">Entry</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可能在两个请求之间的分秒中添加或删除了一个。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要避免此问题，只需保存
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并重复使用它：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">queryset</span> <span class="o">=</span> <span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">([</span><span class="n">p</span><span class="o">.</span><span class="n">headline</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">queryset</span><span class="p">])</span> <span class="c1"># Evaluate the query set.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">([</span><span class="n">p</span><span class="o">.</span><span class="n">pub_date</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">queryset</span><span class="p">])</span> <span class="c1"># Re-use the cache from the evaluation.</span>
</pre></div>
</div>
<div class="section" id="s-when-querysets-are-not-cached">
<span id="when-querysets-are-not-cached"></span><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当</font></font><code class="docutils literal notranslate"><span class="pre">QuerySet</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s没有被缓存时</font></font><a class="headerlink" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#when-querysets-are-not-cached" title="永久链接至标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h4>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查询集并不总是缓存其结果。</font><font style="vertical-align: inherit;">仅评估</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">部分查询集</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">时，将检查缓存，但如果未填充，则不会缓存后续查询返回的项。</font><font style="vertical-align: inherit;">具体而言，这意味着，
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#limiting-querysets"><span class="std std-ref"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">限制所述查询集</font></font></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用阵列切片或索引不会填充缓存。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例如，在queryset对象中重复获取某个索引将每次查询数据库：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">queryset</span> <span class="o">=</span> <span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">queryset</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span> <span class="c1"># Queries the database</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">queryset</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span> <span class="c1"># Queries the database again</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">但是，如果已经评估了整个查询集，则将检查缓存：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">queryset</span> <span class="o">=</span> <span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">entry</span> <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">queryset</span><span class="p">]</span> <span class="c1"># Queries the database</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">queryset</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span> <span class="c1"># Uses cache</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">queryset</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span> <span class="c1"># Uses cache</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以下是一些其他操作的示例，这些操作将导致整个查询集被评估，从而填充缓存：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">entry</span> <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">queryset</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">bool</span><span class="p">(</span><span class="n">queryset</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">entry</span> <span class="ow">in</span> <span class="n">queryset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">queryset</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注解</font></font></p>
<p class="last"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">只需打印查询集就不会填充缓存。</font><font style="vertical-align: inherit;">这是因为调用</font></font><code class="docutils literal notranslate"><span class="pre">__repr__()</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仅返回整个查询集的一部分。</font></font></p>
</div>
</div>
</div>
</div>
<div class="section" id="s-complex-lookups-with-q-objects">
<span id="s-complex-lookups-with-q"></span><span id="complex-lookups-with-q-objects"></span><span id="complex-lookups-with-q"></span><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font></font><code class="docutils literal notranslate"><span class="pre">Q</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对象进行</font><font style="vertical-align: inherit;">复杂查找</font></font><a class="headerlink" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#complex-lookups-with-q-objects" title="永久链接至标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h2>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">关键字参数查询 - 输入</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet.filter" title="django.db.models.query.QuerySet.filter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">filter()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">等 - 是“AND”编辑在一起的。</font><font style="vertical-align: inherit;">如果需要执行更复杂的查询（例如，带</font></font><code class="docutils literal notranslate"><span class="pre">OR</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句的</font><font style="vertical-align: inherit;">查询</font><font style="vertical-align: inherit;">），则可以使用</font><font style="vertical-align: inherit;">。</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.Q" title="django.db.models.Q"><code class="xref py py-class docutils literal notranslate"><span class="pre">Q</span> <span class="pre">objects</span></code></a><font style="vertical-align: inherit;"></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A </font><font style="vertical-align: inherit;">（</font><font style="vertical-align: inherit;">）是用于封装关键字参数集合的对象。</font><font style="vertical-align: inherit;">这些关键字参数在上面的“字段查找”中指定。</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.Q" title="django.db.models.Q"><code class="xref py py-class docutils literal notranslate"><span class="pre">Q</span> <span class="pre">object</span></code></a><font style="vertical-align: inherit;"></font><code class="docutils literal notranslate"><span class="pre">django.db.models.Q</span></code><font style="vertical-align: inherit;"></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例如，此</font></font><code class="docutils literal notranslate"><span class="pre">Q</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对象封装了一个</font></font><code class="docutils literal notranslate"><span class="pre">LIKE</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查询：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.db.models</span> <span class="k">import</span> <span class="n">Q</span>
<span class="n">Q</span><span class="p">(</span><span class="n">question__startswith</span><span class="o">=</span><span class="s1">'What'</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Q</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以使用</font></font><code class="docutils literal notranslate"><span class="pre">&amp;</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="docutils literal notranslate"><span class="pre">|</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">运算符</font><font style="vertical-align: inherit;">组合对象</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">当在两个</font></font><code class="docutils literal notranslate"><span class="pre">Q</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对象</font><font style="vertical-align: inherit;">上使用运算符时</font><font style="vertical-align: inherit;">，它会生成一个新</font></font><code class="docutils literal notranslate"><span class="pre">Q</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对象。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例如，此语句生成一个</font></font><code class="docutils literal notranslate"><span class="pre">Q</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示两个</font></font><code class="docutils literal notranslate"><span class="pre">"question__startswith"</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查询</font><font style="vertical-align: inherit;">的“OR”的对象</font><font style="vertical-align: inherit;">：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Q</span><span class="p">(</span><span class="n">question__startswith</span><span class="o">=</span><span class="s1">'Who'</span><span class="p">)</span> <span class="o">|</span> <span class="n">Q</span><span class="p">(</span><span class="n">question__startswith</span><span class="o">=</span><span class="s1">'What'</span><span class="p">)</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这相当于以下SQL </font></font><code class="docutils literal notranslate"><span class="pre">WHERE</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">WHERE</span> <span class="n">question</span> <span class="n">LIKE</span> <span class="s1">'Who%'</span> <span class="n">OR</span> <span class="n">question</span> <span class="n">LIKE</span> <span class="s1">'What%'</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您可以通过合并组成任意复杂的报表</font></font><code class="docutils literal notranslate"><span class="pre">Q</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与对象</font></font><code class="docutils literal notranslate"><span class="pre">&amp;</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="docutils literal notranslate"><span class="pre">|</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">运营商，并使用括号分组。</font><font style="vertical-align: inherit;">此外，</font></font><code class="docutils literal notranslate"><span class="pre">Q</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
可以使用</font></font><code class="docutils literal notranslate"><span class="pre">~</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">运算符</font><font style="vertical-align: inherit;">取消对象</font><font style="vertical-align: inherit;">，允许组合查找结合常规查询和negated（</font></font><code class="docutils literal notranslate"><span class="pre">NOT</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）查询：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Q</span><span class="p">(</span><span class="n">question__startswith</span><span class="o">=</span><span class="s1">'Who'</span><span class="p">)</span> <span class="o">|</span> <span class="o">~</span><span class="n">Q</span><span class="p">(</span><span class="n">pub_date__year</span><span class="o">=</span><span class="mi">2005</span><span class="p">)</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">每个查找函数，采用关键字参数（例如</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet.filter" title="django.db.models.query.QuerySet.filter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">filter()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet.exclude" title="django.db.models.query.QuerySet.exclude"><code class="xref py py-meth docutils literal notranslate"><span class="pre">exclude()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet.get" title="django.db.models.query.QuerySet.get"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）也可以通过一个或多个
 </font></font><code class="docutils literal notranslate"><span class="pre">Q</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对象作为位置（未命名的）参数。</font><font style="vertical-align: inherit;">如果为</font></font><code class="docutils literal notranslate"><span class="pre">Q</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查找函数</font><font style="vertical-align: inherit;">提供多个
 </font><font style="vertical-align: inherit;">对象参数，则参数将“AND”编辑在一起。</font><font style="vertical-align: inherit;">例如：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Poll</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
    <span class="n">Q</span><span class="p">(</span><span class="n">question__startswith</span><span class="o">=</span><span class="s1">'Who'</span><span class="p">),</span>
    <span class="n">Q</span><span class="p">(</span><span class="n">pub_date</span><span class="o">=</span><span class="n">date</span><span class="p">(</span><span class="mi">2005</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">|</span> <span class="n">Q</span><span class="p">(</span><span class="n">pub_date</span><span class="o">=</span><span class="n">date</span><span class="p">(</span><span class="mi">2005</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="p">)</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">...大致翻译成SQL：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="o">*</span> <span class="kn">from</span> <span class="nn">polls</span> <span class="n">WHERE</span> <span class="n">question</span> <span class="n">LIKE</span> <span class="s1">'Who%'</span>
    <span class="n">AND</span> <span class="p">(</span><span class="n">pub_date</span> <span class="o">=</span> <span class="s1">'2005-05-02'</span> <span class="n">OR</span> <span class="n">pub_date</span> <span class="o">=</span> <span class="s1">'2005-05-06'</span><span class="p">)</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查找函数可以混合使用</font></font><code class="docutils literal notranslate"><span class="pre">Q</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对象和关键字参数。</font><font style="vertical-align: inherit;">提供给查找函数的所有参数（无论是关键字参数还是</font></font><code class="docutils literal notranslate"><span class="pre">Q</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
对象）都是“AND”编辑在一起的。</font><font style="vertical-align: inherit;">但是，如果</font></font><code class="docutils literal notranslate"><span class="pre">Q</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">提供</font><font style="vertical-align: inherit;">了</font><font style="vertical-align: inherit;">对象，则它必须位于任何关键字参数的定义之前。</font><font style="vertical-align: inherit;">例如：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Poll</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
    <span class="n">Q</span><span class="p">(</span><span class="n">pub_date</span><span class="o">=</span><span class="n">date</span><span class="p">(</span><span class="mi">2005</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">|</span> <span class="n">Q</span><span class="p">(</span><span class="n">pub_date</span><span class="o">=</span><span class="n">date</span><span class="p">(</span><span class="mi">2005</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)),</span>
    <span class="n">question__startswith</span><span class="o">=</span><span class="s1">'Who'</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">...将是一个有效的查询，等同于前面的示例; </font><font style="vertical-align: inherit;">但：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># INVALID QUERY</span>
<span class="n">Poll</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
    <span class="n">question__startswith</span><span class="o">=</span><span class="s1">'Who'</span><span class="p">,</span>
    <span class="n">Q</span><span class="p">(</span><span class="n">pub_date</span><span class="o">=</span><span class="n">date</span><span class="p">(</span><span class="mi">2005</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">|</span> <span class="n">Q</span><span class="p">(</span><span class="n">pub_date</span><span class="o">=</span><span class="n">date</span><span class="p">(</span><span class="mi">2005</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="p">)</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">......无效。</font></font></p>
<div class="admonition seealso">
<p class="first admonition-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参见</font></font></p>
<p class="last"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Django的单元测试中</font><font style="vertical-align: inherit;">的</font></font><a class="reference external" href="https://github.com/django/django/blob/stable/2.2.x/tests/or_lookups/tests.py"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OR查找示例</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">显示了一些可能的用法</font></font><code class="docutils literal notranslate"><span class="pre">Q</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
</div>
</div>
<div class="section" id="s-comparing-objects">
<span id="comparing-objects"></span><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">比较对象</font></font><a class="headerlink" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#comparing-objects" title="永久链接至标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h2>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要比较两个模型实例，只需使用标准的Python比较运算符，即双等号：</font></font><code class="docutils literal notranslate"><span class="pre">==</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在幕后，比较两个模型的主键值。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font></font><code class="docutils literal notranslate"><span class="pre">Entry</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上面</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">示例，以下两个语句是等效的：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">some_entry</span> <span class="o">==</span> <span class="n">other_entry</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">some_entry</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">other_entry</span><span class="o">.</span><span class="n">id</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果未调用模型的主键</font></font><code class="docutils literal notranslate"><span class="pre">id</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则没问题。</font><font style="vertical-align: inherit;">比较将始终使用主键，无论它被调用。</font><font style="vertical-align: inherit;">例如，如果调用模型的主键字段</font></font><code class="docutils literal notranslate"><span class="pre">name</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则这两个语句是等效的：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">some_obj</span> <span class="o">==</span> <span class="n">other_obj</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">some_obj</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">other_obj</span><span class="o">.</span><span class="n">name</span>
</pre></div>
</div>
</div>
<div class="section" id="s-deleting-objects">
<span id="s-topics-db-queries-delete"></span><span id="deleting-objects"></span><span id="topics-db-queries-delete"></span><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">删除对象</font></font><a class="headerlink" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#deleting-objects" title="永久链接至标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h2>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方便地命名删除方法
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/instances/#django.db.models.Model.delete" title="django.db.models.Model.delete"><code class="xref py py-meth docutils literal notranslate"><span class="pre">delete()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">此方法立即删除对象并返回已删除的对象数和具有每个对象类型的删除数的字典。</font><font style="vertical-align: inherit;">例：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
<span class="go">(1, {'weblog.Entry': 1})</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您也可以批量删除对象。</font><font style="vertical-align: inherit;">每个人
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">都有一个
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet.delete" title="django.db.models.query.QuerySet.delete"><code class="xref py py-meth docutils literal notranslate"><span class="pre">delete()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法，删除所有成员</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例如，这会删除</font><font style="vertical-align: inherit;">2005年的</font><font style="vertical-align: inherit;">所有</font></font><code class="docutils literal notranslate"><span class="pre">Entry</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对象</font></font><code class="docutils literal notranslate"><span class="pre">pub_date</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pub_date__year</span><span class="o">=</span><span class="mi">2005</span><span class="p">)</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
<span class="go">(5, {'webapp.Entry': 5})</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请记住，只要有可能，这将完全在SQL中执行，因此</font></font><code class="docutils literal notranslate"><span class="pre">delete()</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在此过程中不一定会调用单个对象实例的方法。</font><font style="vertical-align: inherit;">如果您</font></font><code class="docutils literal notranslate"><span class="pre">delete()</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在模型类上</font><font style="vertical-align: inherit;">提供了自定义</font><font style="vertical-align: inherit;">方法并希望确保调用它，则需要“手动”删除该模型的实例（例如，通过迭代
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并</font></font><code class="docutils literal notranslate"><span class="pre">delete()</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">单独</font><font style="vertical-align: inherit;">调用</font><font style="vertical-align: inherit;">每个对象）而不是使用a的批量
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet.delete" title="django.db.models.query.QuerySet.delete"><code class="xref py py-meth docutils literal notranslate"><span class="pre">delete()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当Django删除一个对象时，默认情况下它会模拟SQL约束的行为</font><font style="vertical-align: inherit;">- 换句话说，任何具有指向要删除的对象的外键的对象都将随之删除。</font><font style="vertical-align: inherit;">例如：</font></font><code class="docutils literal notranslate"><span class="pre">ON</span> <span class="pre">DELETE</span> <span class="pre">CASCADE</span></code><font style="vertical-align: inherit;"></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">Blog</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># This will delete the Blog and all of its Entry objects.</span>
<span class="n">b</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这种级联行为可以通过</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/fields/#django.db.models.ForeignKey.on_delete" title="django.db.models.ForeignKey.on_delete"><code class="xref py py-attr docutils literal notranslate"><span class="pre">on_delete</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参数来
 </font><font style="vertical-align: inherit;">定制
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/fields/#django.db.models.ForeignKey" title="django.db.models.ForeignKey"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForeignKey</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请注意，这</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet.delete" title="django.db.models.query.QuerySet.delete"><code class="xref py py-meth docutils literal notranslate"><span class="pre">delete()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是唯一
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">未在</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/managers/#django.db.models.Manager" title="django.db.models.Manager"><code class="xref py py-class docutils literal notranslate"><span class="pre">Manager</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自身</font><font style="vertical-align: inherit;">上公开的方法
 </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这是一种安全机制，可防止您意外请求</font></font><code class="docutils literal notranslate"><span class="pre">Entry.objects.delete()</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和删除</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">所有</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">条目。</font><font style="vertical-align: inherit;">如果您</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">确实</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要删除所有对象，则必须显式请求完整的查询集：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="s-copying-model-instances">
<span id="s-topics-db-queries-copy"></span><span id="copying-model-instances"></span><span id="topics-db-queries-copy"></span><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">复制模型实例</font></font><a class="headerlink" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#copying-model-instances" title="永久链接至标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h2>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">虽然没有用于复制模型实例的内置方法，但可以轻松创建复制了所有字段值的新实例。</font><font style="vertical-align: inherit;">在最简单的情况下，您可以设置</font></font><code class="docutils literal notranslate"><span class="pre">pk</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为</font></font><code class="docutils literal notranslate"><span class="pre">None</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">使用我们的博客示例：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">blog</span> <span class="o">=</span> <span class="n">Blog</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">'My blog'</span><span class="p">,</span> <span class="n">tagline</span><span class="o">=</span><span class="s1">'Blogging is easy'</span><span class="p">)</span>
<span class="n">blog</span><span class="o">.</span><span class="n">save</span><span class="p">()</span> <span class="c1"># blog.pk == 1</span>

<span class="n">blog</span><span class="o">.</span><span class="n">pk</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">blog</span><span class="o">.</span><span class="n">save</span><span class="p">()</span> <span class="c1"># blog.pk == 2</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果使用继承，事情会变得更复杂。</font><font style="vertical-align: inherit;">考虑一个子类
 </font></font><code class="docutils literal notranslate"><span class="pre">Blog</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ThemeBlog</span><span class="p">(</span><span class="n">Blog</span><span class="p">):</span>
    <span class="n">theme</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>

<span class="n">django_blog</span> <span class="o">=</span> <span class="n">ThemeBlog</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">'Django'</span><span class="p">,</span> <span class="n">tagline</span><span class="o">=</span><span class="s1">'Django is easy'</span><span class="p">,</span> <span class="n">theme</span><span class="o">=</span><span class="s1">'python'</span><span class="p">)</span>
<span class="n">django_blog</span><span class="o">.</span><span class="n">save</span><span class="p">()</span> <span class="c1"># django_blog.pk == 3</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">由于继承的工作原理，您必须将both </font></font><code class="docutils literal notranslate"><span class="pre">pk</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font><font style="vertical-align: inherit;">都设置</font></font><code class="docutils literal notranslate"><span class="pre">id</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为None：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">django_blog</span><span class="o">.</span><span class="n">pk</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">django_blog</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">django_blog</span><span class="o">.</span><span class="n">save</span><span class="p">()</span> <span class="c1"># django_blog.pk == 4</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">此过程不会复制不属于模型数据库表的关系。</font><font style="vertical-align: inherit;">例如，</font></font><code class="docutils literal notranslate"><span class="pre">Entry</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有一个</font></font><code class="docutils literal notranslate"><span class="pre">ManyToManyField</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">到</font></font><code class="docutils literal notranslate"><span class="pre">Author</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">复制条目后，必须为新条目设置多对多关系：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">entry</span> <span class="o">=</span> <span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># some previous entry</span>
<span class="n">old_authors</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">authors</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="n">entry</span><span class="o">.</span><span class="n">pk</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">entry</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
<span class="n">entry</span><span class="o">.</span><span class="n">authors</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">old_authors</span><span class="p">)</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对于a </font></font><code class="docutils literal notranslate"><span class="pre">OneToOneField</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，您必须复制相关对象并将其分配给新对象的字段，以避免违反一对一唯一约束。</font><font style="vertical-align: inherit;">例如，假设</font></font><code class="docutils literal notranslate"><span class="pre">entry</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">已经如上所述重复：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">detail</span> <span class="o">=</span> <span class="n">EntryDetail</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">detail</span><span class="o">.</span><span class="n">pk</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">detail</span><span class="o">.</span><span class="n">entry</span> <span class="o">=</span> <span class="n">entry</span>
<span class="n">detail</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="s-updating-multiple-objects-at-once">
<span id="s-topics-db-queries-update"></span><span id="updating-multiple-objects-at-once"></span><span id="topics-db-queries-update"></span><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一次更新多个对象</font></font><a class="headerlink" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#updating-multiple-objects-at-once" title="永久链接至标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h2>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有时您希望将字段设置为a中所有对象的特定值</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">您可以使用该</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet.update" title="django.db.models.query.QuerySet.update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">update()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法</font><font style="vertical-align: inherit;">执行此操作
 </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">例如：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Update all the headlines with pub_date in 2007.</span>
<span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">pub_date__year</span><span class="o">=</span><span class="mi">2007</span><span class="p">)</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">headline</span><span class="o">=</span><span class="s1">'Everything is the same'</span><span class="p">)</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您只能</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/fields/#django.db.models.ForeignKey" title="django.db.models.ForeignKey"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForeignKey</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
使用此方法</font><font style="vertical-align: inherit;">设置非关系字段和</font><font style="vertical-align: inherit;">字段。</font><font style="vertical-align: inherit;">要更新非关系字段，请将新值作为常量提供。</font><font style="vertical-align: inherit;">要更新</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/fields/#django.db.models.ForeignKey" title="django.db.models.ForeignKey"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForeignKey</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字段，请将新值设置为要指向的新模型实例。</font><font style="vertical-align: inherit;">例如：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">Blog</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="go"># Change every Entry so that it belongs to this Blog.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">blog</span><span class="o">=</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该</font></font><code class="docutils literal notranslate"><span class="pre">update()</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法立即应用并返回查询匹配的行数（如果某些行已经具有新值，则可能不等于更新的行数）。</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更新</font><font style="vertical-align: inherit;">的唯一限制
 </font><font style="vertical-align: inherit;">是它只能访问一个数据库表：模型的主表。</font><font style="vertical-align: inherit;">您可以根据相关字段进行过滤，但只能更新模型主表中的列。</font><font style="vertical-align: inherit;">例：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">Blog</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="go"># Update all the headlines belonging to this Blog.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">select_related</span><span class="p">()</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">blog</span><span class="o">=</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">headline</span><span class="o">=</span><span class="s1">'Everything is the same'</span><span class="p">)</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请注意，该</font></font><code class="docutils literal notranslate"><span class="pre">update()</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法直接转换为SQL语句。</font><font style="vertical-align: inherit;">这是直接更新的批量操作。</font><font style="vertical-align: inherit;">它不运行任何
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/instances/#django.db.models.Model.save" title="django.db.models.Model.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">你的模型的方法，或发出
 </font></font><code class="docutils literal notranslate"><span class="pre">pre_save</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code class="docutils literal notranslate"><span class="pre">post_save</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">信号（这是调用的结果
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/instances/#django.db.models.Model.save" title="django.db.models.Model.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">），或兑现
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/fields/#django.db.models.DateField.auto_now" title="django.db.models.DateField.auto_now"><code class="xref py py-attr docutils literal notranslate"><span class="pre">auto_now</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">领域选项。</font><font style="vertical-align: inherit;">如果要保存a中的每个项目</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
并确保</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/instances/#django.db.models.Model.save" title="django.db.models.Model.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在每个实例上调用</font><font style="vertical-align: inherit;">该</font><font style="vertical-align: inherit;">方法，则不需要任何特殊功能来处理它。</font><font style="vertical-align: inherit;">只需循环它们并调用</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/instances/#django.db.models.Model.save" title="django.db.models.Model.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">my_queryset</span><span class="p">:</span>
    <span class="n">item</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用更新还可以</font><font style="vertical-align: inherit;">用于根据模型中另一个字段的值更新一个字段。</font><font style="vertical-align: inherit;">这对于基于其当前值递增计数器特别有用。</font><font style="vertical-align: inherit;">例如，要增加博客中每个条目的pingback计数：</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/expressions/#django.db.models.F" title="django.db.models.F"><code class="xref py py-class docutils literal notranslate"><span class="pre">F</span> <span class="pre">expressions</span></code></a><font style="vertical-align: inherit;"></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">n_pingbacks</span><span class="o">=</span><span class="n">F</span><span class="p">(</span><span class="s1">'n_pingbacks'</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">但是，与</font></font><code class="docutils literal notranslate"><span class="pre">F()</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">filter和exclude子句中的</font></font><code class="docutils literal notranslate"><span class="pre">F()</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对象不同，在更新中</font><font style="vertical-align: inherit;">使用</font><font style="vertical-align: inherit;">对象</font><font style="vertical-align: inherit;">时不能引入连接</font><font style="vertical-align: inherit;">- 您只能引用要更新的模型的本地字段。</font><font style="vertical-align: inherit;">如果您尝试引入与</font></font><code class="docutils literal notranslate"><span class="pre">F()</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对象</font><font style="vertical-align: inherit;">的连接</font><font style="vertical-align: inherit;">，</font></font><code class="docutils literal notranslate"><span class="pre">FieldError</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则将引发：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># This will raise a FieldError</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">headline</span><span class="o">=</span><span class="n">F</span><span class="p">(</span><span class="s1">'blog__name'</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="s-related-objects">
<span id="s-topics-db-queries-related"></span><span id="related-objects"></span><span id="topics-db-queries-related"></span><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">相关对象</font></font><a class="headerlink" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#related-objects" title="永久链接至标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h2>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当您在模型中定义关系（即a
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/fields/#django.db.models.ForeignKey" title="django.db.models.ForeignKey"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForeignKey</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/fields/#django.db.models.OneToOneField" title="django.db.models.OneToOneField"><code class="xref py py-class docutils literal notranslate"><span class="pre">OneToOneField</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/fields/#django.db.models.ManyToManyField" title="django.db.models.ManyToManyField"><code class="xref py py-class docutils literal notranslate"><span class="pre">ManyToManyField</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）时，该模型的实例将具有访问相关对象的便捷API。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例如，使用本页顶部的模型，</font></font><code class="docutils literal notranslate"><span class="pre">Entry</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对象</font></font><code class="docutils literal notranslate"><span class="pre">e</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
可以</font></font><code class="docutils literal notranslate"><span class="pre">Blog</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过访问</font></font><code class="docutils literal notranslate"><span class="pre">blog</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font><font style="vertical-align: inherit;">来获取其关联</font><font style="vertical-align: inherit;">对象</font><font style="vertical-align: inherit;">：
 </font></font><code class="docutils literal notranslate"><span class="pre">e.blog</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（在幕后，这个功能是由Python </font></font><a class="reference external" href="https://docs.python.org/howto/descriptor.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述符</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实现的</font><font style="vertical-align: inherit;">。这对你来说并不重要，但我们在这里指出它是好奇的。）</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Django还为关系的“其他”方创建API访问器 - 从相关模型到定义关系的模型的链接。</font><font style="vertical-align: inherit;">例如，</font></font><code class="docutils literal notranslate"><span class="pre">Blog</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对象</font></font><code class="docutils literal notranslate"><span class="pre">b</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以</font></font><code class="docutils literal notranslate"><span class="pre">Entry</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过以下</font></font><code class="docutils literal notranslate"><span class="pre">entry_set</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font><font style="vertical-align: inherit;">访问所有相关</font><font style="vertical-align: inherit;">对象</font><font style="vertical-align: inherit;">的列表
 </font><font style="vertical-align: inherit;">：</font></font><code class="docutils literal notranslate"><span class="pre">b.entry_set.all()</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在本节中的所有示例使用示例</font></font><code class="docutils literal notranslate"><span class="pre">Blog</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="docutils literal notranslate"><span class="pre">Author</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并</font></font><code class="docutils literal notranslate"><span class="pre">Entry</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在此页面的顶部定义的模型。</font></font></p>
<div class="section" id="s-one-to-many-relationships">
<span id="one-to-many-relationships"></span><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一对多关系</font></font><a class="headerlink" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#one-to-many-relationships" title="永久链接至标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h3>
<div class="section" id="s-forward">
<span id="forward"></span><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">转发</font></font><a class="headerlink" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#forward" title="永久链接至标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h4>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果模型具有a </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/fields/#django.db.models.ForeignKey" title="django.db.models.ForeignKey"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForeignKey</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则该模型的实例将通过模型的简单属性访问相关（外部）对象。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">举例：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">blog</span> <span class="c1"># Returns the related Blog object.</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您可以通过外键属性获取和设置。</font><font style="vertical-align: inherit;">正如您所料，在您调用之前，对外键的更改不会保存到数据库中
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/instances/#django.db.models.Model.save" title="django.db.models.Model.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save()</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">例：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">blog</span> <span class="o">=</span> <span class="n">some_blog</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/fields/#django.db.models.ForeignKey" title="django.db.models.ForeignKey"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForeignKey</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字段已</font></font><code class="docutils literal notranslate"><span class="pre">null=True</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">设置（即，它允许</font></font><code class="docutils literal notranslate"><span class="pre">NULL</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">值），则可以指定</font></font><code class="docutils literal notranslate"><span class="pre">None</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">删除关系。</font><font style="vertical-align: inherit;">例：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">blog</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">save</span><span class="p">()</span> <span class="c1"># "UPDATE blog_entry SET blog_id = NULL ...;"</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第一次访问相关对象时，将缓存对一对多关系的转发访问。</font><font style="vertical-align: inherit;">对高速缓存在同一对象实例上的外键的后续访问。</font><font style="vertical-align: inherit;">例：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">blog</span><span class="p">)</span>  <span class="c1"># Hits the database to retrieve the associated Blog.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">blog</span><span class="p">)</span>  <span class="c1"># Doesn't hit the database; uses cached version.</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请注意，该</font><font style="vertical-align: inherit;">方法提前预先填充所有一对多关系的缓存。</font><font style="vertical-align: inherit;">例：</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet.select_related" title="django.db.models.query.QuerySet.select_related"><code class="xref py py-meth docutils literal notranslate"><span class="pre">select_related()</span></code></a>
<a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">select_related</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">blog</span><span class="p">)</span>  <span class="c1"># Doesn't hit the database; uses cached version.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">blog</span><span class="p">)</span>  <span class="c1"># Doesn't hit the database; uses cached version.</span>
</pre></div>
</div>
</div>
<div class="section" id="s-following-relationships-backward">
<span id="s-backwards-related-objects"></span><span id="following-relationships-backward"></span><span id="backwards-related-objects"></span><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以下关系“向后” </font></font><a class="headerlink" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#following-relationships-backward" title="永久链接至标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h4>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果模型具有a </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/fields/#django.db.models.ForeignKey" title="django.db.models.ForeignKey"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForeignKey</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则外键模型的实例将具有对其</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/managers/#django.db.models.Manager" title="django.db.models.Manager"><code class="xref py py-class docutils literal notranslate"><span class="pre">Manager</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回第一模型的所有实例的</font><font style="vertical-align: inherit;">访问权</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">默认情况下，这
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/managers/#django.db.models.Manager" title="django.db.models.Manager"><code class="xref py py-class docutils literal notranslate"><span class="pre">Manager</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是命名的</font></font><code class="docutils literal notranslate"><span class="pre">FOO_set</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="docutils literal notranslate"><span class="pre">FOO</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">源模型名称是小写的。</font><font style="vertical-align: inherit;">此</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/managers/#django.db.models.Manager" title="django.db.models.Manager"><code class="xref py py-class docutils literal notranslate"><span class="pre">Manager</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回
 </font></font><code class="docutils literal notranslate"><span class="pre">QuerySets</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，其可以被过滤和操纵与上述“检索对象”部分中描述。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">举例：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">Blog</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">entry_set</span><span class="o">.</span><span class="n">all</span><span class="p">()</span> <span class="c1"># Returns all Entry objects related to Blog.</span>

<span class="go"># b.entry_set is a Manager that returns QuerySets.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">entry_set</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">headline__contains</span><span class="o">=</span><span class="s1">'Lennon'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">entry_set</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您可以</font></font><code class="docutils literal notranslate"><span class="pre">FOO_set</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/fields/#django.db.models.ForeignKey.related_name" title="django.db.models.ForeignKey.related_name"><code class="xref py py-attr docutils literal notranslate"><span class="pre">related_name</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/fields/#django.db.models.ForeignKey" title="django.db.models.ForeignKey"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForeignKey</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">定义中</font><font style="vertical-align: inherit;">设置</font><font style="vertical-align: inherit;">参数
 </font><font style="vertical-align: inherit;">来覆盖</font><font style="vertical-align: inherit;">名称
 </font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">例如，如果</font></font><code class="docutils literal notranslate"><span class="pre">Entry</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
模型被更改为</font><font style="vertical-align: inherit;">，上面的示例代码将如下所示：</font></font><code class="docutils literal notranslate"><span class="pre">blog</span> <span class="pre">=</span> <span class="pre">ForeignKey(Blog,</span> <span class="pre">on_delete=models.CASCADE,</span>
<span class="pre">related_name='entries')</span></code><font style="vertical-align: inherit;"></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">Blog</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">entries</span><span class="o">.</span><span class="n">all</span><span class="p">()</span> <span class="c1"># Returns all Entry objects related to Blog.</span>

<span class="go"># b.entries is a Manager that returns QuerySets.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">entries</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">headline__contains</span><span class="o">=</span><span class="s1">'Lennon'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">entries</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="s-using-a-custom-reverse-manager">
<span id="s-using-custom-reverse-manager"></span><span id="using-a-custom-reverse-manager"></span><span id="using-custom-reverse-manager"></span><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用自定义反向管理器</font></font><a class="headerlink" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#using-a-custom-reverse-manager" title="永久链接至标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h4>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认情况下，</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/relations/#django.db.models.fields.related.RelatedManager" title="django.db.models.fields.related.RelatedManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">RelatedManager</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用于反向关系的是</font><font style="vertical-align: inherit;">
该模型</font><font style="vertical-align: inherit;">的</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/managers/#manager-names"><span class="std std-ref"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">默认管理器</font></font></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的子类</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果要为给定查询指定其他管理器，可以使用以下语法：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.db</span> <span class="k">import</span> <span class="n">models</span>

<span class="k">class</span> <span class="nc">Entry</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="c1">#...</span>
    <span class="n">objects</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Manager</span><span class="p">()</span>  <span class="c1"># Default Manager</span>
    <span class="n">entries</span> <span class="o">=</span> <span class="n">EntryManager</span><span class="p">()</span>    <span class="c1"># Custom Manager</span>

<span class="n">b</span> <span class="o">=</span> <span class="n">Blog</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">b</span><span class="o">.</span><span class="n">entry_set</span><span class="p">(</span><span class="n">manager</span><span class="o">=</span><span class="s1">'entries'</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果</font></font><code class="docutils literal notranslate"><span class="pre">EntryManager</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在其</font></font><code class="docutils literal notranslate"><span class="pre">get_queryset()</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
方法中</font><font style="vertical-align: inherit;">执行默认过滤</font><font style="vertical-align: inherit;">，则该过滤将应用于该</font></font><code class="docutils literal notranslate"><span class="pre">all()</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当然，指定自定义反向管理器还可以调用其自定义方法：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">b</span><span class="o">.</span><span class="n">entry_set</span><span class="p">(</span><span class="n">manager</span><span class="o">=</span><span class="s1">'entries'</span><span class="p">)</span><span class="o">.</span><span class="n">is_published</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="s-additional-methods-to-handle-related-objects">
<span id="additional-methods-to-handle-related-objects"></span><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">处理相关对象的其他方法</font></font><a class="headerlink" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#additional-methods-to-handle-related-objects" title="永久链接至标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h4>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">除了</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/querysets/#django.db.models.query.QuerySet" title="django.db.models.query.QuerySet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuerySet</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上面“检索对象”中定义</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">方法之外，</font><font style="vertical-align: inherit;">还有用于处理相关对象集的其他方法。</font><font style="vertical-align: inherit;">每个的概要如下，完整的细节可以在</font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/relations/"><span class="doc"><font style="vertical-align: inherit;">相关的对象参考中找到</font></span></a><font style="vertical-align: inherit;">。</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/fields/#django.db.models.ForeignKey" title="django.db.models.ForeignKey"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForeignKey</span></code></a>
<a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/managers/#django.db.models.Manager" title="django.db.models.Manager"><code class="xref py py-class docutils literal notranslate"><span class="pre">Manager</span></code></a><font style="vertical-align: inherit;"></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/relations/"><span class="doc"><font style="vertical-align: inherit;"></font></span></a><font style="vertical-align: inherit;"></font></p>
<dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">add(obj1,</span> <span class="pre">obj2,</span> <span class="pre">...)</span></code></dt>
<dd><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将特定的模型对象加入关联对象集合。</font></font></dd>
<dt><code class="docutils literal notranslate"><span class="pre">create(**kwargs)</span></code></dt>
<dd><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">创建一个新对象，保存它并将其放入相关的对象集中。</font><font style="vertical-align: inherit;">返回新创建的对象。</font></font></dd>
<dt><code class="docutils literal notranslate"><span class="pre">remove(obj1,</span> <span class="pre">obj2,</span> <span class="pre">...)</span></code></dt>
<dd><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从相关对象集中删除指定的模型对象。</font></font></dd>
<dt><code class="docutils literal notranslate"><span class="pre">clear()</span></code></dt>
<dd><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从相关对象集中删除所有对象。</font></font></dd>
<dt><code class="docutils literal notranslate"><span class="pre">set(objs)</span></code></dt>
<dd><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">替换相关对象集。</font></font></dd>
</dl>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要分配相关集的成员，请将该</font></font><code class="docutils literal notranslate"><span class="pre">set()</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法与可迭代的对象实例一起使用。</font><font style="vertical-align: inherit;">例如，if </font></font><code class="docutils literal notranslate"><span class="pre">e1</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="docutils literal notranslate"><span class="pre">e2</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是</font></font><code class="docutils literal notranslate"><span class="pre">Entry</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
实例：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">Blog</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">b</span><span class="o">.</span><span class="n">entry_set</span><span class="o">.</span><span class="n">set</span><span class="p">([</span><span class="n">e1</span><span class="p">,</span> <span class="n">e2</span><span class="p">])</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果该</font></font><code class="docutils literal notranslate"><span class="pre">clear()</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法可用，则将从</font></font><code class="docutils literal notranslate"><span class="pre">entry_set</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">迭代中的所有对象（在本例中为列表）添加到集合之前</font><font style="vertical-align: inherit;">删除任何预先存在的对象</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果该</font></font><code class="docutils literal notranslate"><span class="pre">clear()</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不可</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
用，则将添加iterable中的所有对象，而不删除任何现有元素。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">本节中描述的每个“反向”操作都会立即对数据库产生影响。</font><font style="vertical-align: inherit;">每次添加，创建和删除都会立即自动保存到数据库中。</font></font></p>
</div>
</div>
<div class="section" id="s-many-to-many-relationships">
<span id="s-m2m-reverse-relationships"></span><span id="many-to-many-relationships"></span><span id="m2m-reverse-relationships"></span><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">多对多关系</font></font><a class="headerlink" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#many-to-many-relationships" title="永久链接至标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h3>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">多对多关系的两端都可以自动访问另一端的API。</font><font style="vertical-align: inherit;">API的工作方式类似于上面的“向后”一对多关系。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一个区别在于属性命名：定义的模型
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/fields/#django.db.models.ManyToManyField" title="django.db.models.ManyToManyField"><code class="xref py py-class docutils literal notranslate"><span class="pre">ManyToManyField</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用该字段本身的属性名称，而“反向”模型使用原始模型的小写模型名称，加上</font></font><code class="docutils literal notranslate"><span class="pre">'_set'</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（就像反向一对多关系一样） 。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一个例子使这更容易理解：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">e</span> <span class="o">=</span> <span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">e</span><span class="o">.</span><span class="n">authors</span><span class="o">.</span><span class="n">all</span><span class="p">()</span> <span class="c1"># Returns all Author objects for this Entry.</span>
<span class="n">e</span><span class="o">.</span><span class="n">authors</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="n">e</span><span class="o">.</span><span class="n">authors</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">name__contains</span><span class="o">=</span><span class="s1">'John'</span><span class="p">)</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">a</span><span class="o">.</span><span class="n">entry_set</span><span class="o">.</span><span class="n">all</span><span class="p">()</span> <span class="c1"># Returns all Entry objects for this Author.</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">喜欢</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/fields/#django.db.models.ForeignKey" title="django.db.models.ForeignKey"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForeignKey</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/fields/#django.db.models.ManyToManyField" title="django.db.models.ManyToManyField"><code class="xref py py-class docutils literal notranslate"><span class="pre">ManyToManyField</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以指定
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/fields/#django.db.models.ManyToManyField.related_name" title="django.db.models.ManyToManyField.related_name"><code class="xref py py-attr docutils literal notranslate"><span class="pre">related_name</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在上面的示例中，如果</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/fields/#django.db.models.ManyToManyField" title="django.db.models.ManyToManyField"><code class="xref py py-class docutils literal notranslate"><span class="pre">ManyToManyField</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in </font></font><code class="docutils literal notranslate"><span class="pre">Entry</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指定了
 </font></font><code class="docutils literal notranslate"><span class="pre">related_name='entries'</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，那么每个</font></font><code class="docutils literal notranslate"><span class="pre">Author</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实例都将具有一个
 </font></font><code class="docutils literal notranslate"><span class="pre">entries</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性而不是</font></font><code class="docutils literal notranslate"><span class="pre">entry_set</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">从一到多的关系的另一个区别是，除了实例，模型</font></font><code class="docutils literal notranslate"><span class="pre">add()</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="docutils literal notranslate"><span class="pre">set()</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="docutils literal notranslate"><span class="pre">remove()</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">许多一对多的关系，接受主键值的方法。</font><font style="vertical-align: inherit;">例如，如果</font></font><code class="docutils literal notranslate"><span class="pre">e1</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="docutils literal notranslate"><span class="pre">e2</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是
 </font></font><code class="docutils literal notranslate"><span class="pre">Entry</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实例，那么这些</font></font><code class="docutils literal notranslate"><span class="pre">set()</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用相同的工作：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">Author</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">a</span><span class="o">.</span><span class="n">entry_set</span><span class="o">.</span><span class="n">set</span><span class="p">([</span><span class="n">e1</span><span class="p">,</span> <span class="n">e2</span><span class="p">])</span>
<span class="n">a</span><span class="o">.</span><span class="n">entry_set</span><span class="o">.</span><span class="n">set</span><span class="p">([</span><span class="n">e1</span><span class="o">.</span><span class="n">pk</span><span class="p">,</span> <span class="n">e2</span><span class="o">.</span><span class="n">pk</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="s-one-to-one-relationships">
<span id="one-to-one-relationships"></span><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一对一的关系</font></font><a class="headerlink" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#one-to-one-relationships" title="永久链接至标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h3>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一对一关系与多对一关系非常相似。</font><font style="vertical-align: inherit;">如果</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/models/fields/#django.db.models.OneToOneField" title="django.db.models.OneToOneField"><code class="xref py py-class docutils literal notranslate"><span class="pre">OneToOneField</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在模型上</font><font style="vertical-align: inherit;">定义a </font><font style="vertical-align: inherit;">，则该模型的实例将通过模型的简单属性访问相关对象。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例如：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">EntryDetail</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">entry</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">OneToOneField</span><span class="p">(</span><span class="n">Entry</span><span class="p">,</span> <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">CASCADE</span><span class="p">)</span>
    <span class="n">details</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">()</span>

<span class="n">ed</span> <span class="o">=</span> <span class="n">EntryDetail</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ed</span><span class="o">.</span><span class="n">entry</span> <span class="c1"># Returns the related Entry object.</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">不同之处在于“反向”查询。</font><font style="vertical-align: inherit;">一对一关系中的相关模型也可以访问</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/managers/#django.db.models.Manager" title="django.db.models.Manager"><code class="xref py py-class docutils literal notranslate"><span class="pre">Manager</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对象，但它</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/managers/#django.db.models.Manager" title="django.db.models.Manager"><code class="xref py py-class docutils literal notranslate"><span class="pre">Manager</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表示单个对象，而不是对象集合：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">e</span> <span class="o">=</span> <span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">e</span><span class="o">.</span><span class="n">entrydetail</span> <span class="c1"># returns the related EntryDetail object</span>
</pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果没有为此关系分配任何对象，Django将引发</font></font><code class="docutils literal notranslate"><span class="pre">DoesNotExist</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">异常。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以按照分配前向关系的相同方式将实例分配给反向关系：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">e</span><span class="o">.</span><span class="n">entrydetail</span> <span class="o">=</span> <span class="n">ed</span>
</pre></div>
</div>
</div>
<div class="section" id="s-how-are-the-backward-relationships-possible">
<span id="how-are-the-backward-relationships-possible"></span><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">落后关系如何可能？</font></font><a class="headerlink" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#how-are-the-backward-relationships-possible" title="永久链接至标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h3>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">其他对象关系映射器要求您在两侧定义关系。</font><font style="vertical-align: inherit;">Django开发人员认为这违反了DRY（不要重复自己）原则，所以Django只要求你在一端定义关系。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">但是，如果模型类在加载其他模型类之前不知道哪些其他模型类与之相关，那么这怎么可能呢？</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">答案在于</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">当Django启动时，它会导入列出的每个应用程序</font><font style="vertical-align: inherit;">，然后</font><font style="vertical-align: inherit;">导入每个应用程序中</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">模块。</font><font style="vertical-align: inherit;">每当创建新的模型类时，Django都会向任何相关模型添加向后关系。</font><font style="vertical-align: inherit;">如果还没有导入相关模型，Django会记录关系并在最终导入相关模型时添加它们。</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/applications/#django.apps.apps" title="django.apps.apps"><code class="xref py py-data docutils literal notranslate"><span class="pre">app</span> <span class="pre">registry</span></code></a><font style="vertical-align: inherit;"></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/settings/#std:setting-INSTALLED_APPS"><code class="xref std std-setting docutils literal notranslate"><span class="pre">INSTALLED_APPS</span></code></a><font style="vertical-align: inherit;"></font><code class="docutils literal notranslate"><span class="pre">models</span></code><font style="vertical-align: inherit;"></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">因此，在您列出的应用程序中定义所有正在使用的模型尤为重要</font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/ref/settings/#std:setting-INSTALLED_APPS"><code class="xref std std-setting docutils literal notranslate"><span class="pre">INSTALLED_APPS</span></code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">否则，向后关系可能无法正常工作。</font></font></p>
</div>
<div class="section" id="s-queries-over-related-objects">
<span id="queries-over-related-objects"></span><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对相关对象的查询</font></font><a class="headerlink" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#queries-over-related-objects" title="永久链接至标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¶</font></font></a></h3>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">涉及相关对象的查询遵循与涉及正常值字段的查询相同的规则。</font><font style="vertical-align: inherit;">指定要匹配的查询的值时，可以使用对象实例本身或对象的主键值。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">举例来说，如果你有一个博客的对象</font></font><code class="docutils literal notranslate"><span class="pre">b</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有</font></font><code class="docutils literal notranslate"><span class="pre">id=5</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，以下三种查询是相同的：</font></font></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">blog</span><span class="o">=</span><span class="n">b</span><span class="p">)</span> <span class="c1"># Query using object instance</span>
<span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">blog</span><span class="o">=</span><span class="n">b</span><span class="o">.</span><span class="n">id</span><span class="p">)</span> <span class="c1"># Query using id from instance</span>
<span class="n">Entry</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">blog</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># Query using id directly</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="s-falling-back-to-raw-sql">
<span id="falling-back-to-raw-sql"></span><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">回退到原始</font></font><a class="headerlink" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#falling-back-to-raw-sql" title="永久链接至标题"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQL¶</font></font></a></h2>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果您发现自己需要编写一个对于Django的数据库映射器来说太复杂的SQL查询来处理，那么您可以依靠手工编写SQL。</font><font style="vertical-align: inherit;">Django有几个编写原始SQL查询的选项; </font><font style="vertical-align: inherit;">请参阅
 </font></font><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/sql/"><span class="doc"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">执行原始SQL查询</font></font></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最后，重要的是要注意Django数据库层只是数据库的接口。</font><font style="vertical-align: inherit;">您可以通过其他工具，编程语言或数据库框架访问您的数据库; </font><font style="vertical-align: inherit;">关于你的数据库没有特定的Django。</font></font></p>
</div>
</div>

</div>



<div class="browse-horizontal">
  
  <div class="left"><a href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/models/"><i class="icon icon-chevron-left"></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 模型</font></font></a></div>
  
  
  <div class="right"><a href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/aggregation/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">聚合 </font></font><i class="icon icon-chevron-right"></i></a></div>
  
</div>



        <a href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#top" class="backtotop"><i class="icon icon-chevron-up"></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 回到顶部</font></font></a>
      </div>

      
<h1 class="visuallyhidden"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">附加信息</font></font></h1>
<div role="complementary">
  
  

<form action="https://docs.djangoproject.com/zh-hans/2.2/search/" class="search form-input" role="search">
  <label class="visuallyhidden" for="id_q"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">搜索：</font></font></label>
    <input type="search" name="q" placeholder="搜索 2.2 文档" id="id_q">

    <button type="submit">
      <i class="icon icon-search"></i>
      <span class="visuallyhidden"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">搜索</font></font></span>
    </button>
</form>

  

  


  <div class="fundraising-sidebar">
    <h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">支持Django！</font></font></h2>

    <div class="small-heart">
      <img src="./12进行查询_files/small-fundraising-heart.d255f6e934e5.png" alt="支持Django！">
    </div>

    <div class="small-cta">
      <ul class="list-links-small">
        <li><a href="https://www.djangoproject.com/fundraising/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
          Sebastian Steins捐赠给Django软件基金会以支持Django开发。</font><font style="vertical-align: inherit;">今天捐款！
        </font></font></a></li>
      </ul>
    </div>
  </div>



  
    <h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">内容</font></font></h2>
    
    <ul>
<li><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">进行查询</font></font></a><ul>
<li><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#creating-objects"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">创建对象</font></font></a></li>
<li><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#saving-changes-to-objects"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">保存对象的更改</font></font></a><ul>
<li><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#saving-foreignkey-and-manytomanyfield-fields"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">保存</font></font><code class="docutils literal notranslate"><span class="pre">ForeignKey</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="docutils literal notranslate"><span class="pre">ManyToManyField</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字段</font></font></a></li>
</ul>
</li>
<li><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#retrieving-objects"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">检索对象</font></font></a><ul>
<li><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#retrieving-all-objects"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">检索所有对象</font></font></a></li>
<li><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#retrieving-specific-objects-with-filters"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用过滤器检索特定对象</font></font></a><ul>
<li><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#chaining-filters"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">链接过滤器</font></font></a></li>
<li><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#filtered-querysets-are-unique"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">过滤的</font></font><code class="docutils literal notranslate"><span class="pre">QuerySet</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s是独一无二的</font></font></a></li>
<li><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#querysets-are-lazy"><code class="docutils literal notranslate"><span class="pre">QuerySet</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s很懒</font></font></a></li>
</ul>
</li>
<li><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#retrieving-a-single-object-with-get"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用检索单个对象 </font></font><code class="docutils literal notranslate"><span class="pre">get()</span></code></a></li>
<li><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#other-queryset-methods"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">其他</font></font><code class="docutils literal notranslate"><span class="pre">QuerySet</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法</font></font></a></li>
<li><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#limiting-querysets"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">限制</font></font><code class="docutils literal notranslate"><span class="pre">QuerySet</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">小号</font></font></a></li>
<li><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#field-lookups"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字段查找</font></font></a></li>
<li><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#lookups-that-span-relationships"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">跨越关系的查找</font></font></a><ul>
<li><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#spanning-multi-valued-relationships"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">跨越多值关系</font></font></a></li>
</ul>
</li>
<li><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#filters-can-reference-fields-on-the-model"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">过滤器可以引用模型上的字段</font></font></a></li>
<li><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#the-pk-lookup-shortcut"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在</font></font><code class="docutils literal notranslate"><span class="pre">pk</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查找快捷</font></font></a></li>
<li><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#escaping-percent-signs-and-underscores-in-like-statements"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在</font></font><code class="docutils literal notranslate"><span class="pre">LIKE</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">陈述</font><font style="vertical-align: inherit;">中转出百分号和下划线</font></font></a></li>
<li><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#caching-and-querysets"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">缓存和</font></font><code class="docutils literal notranslate"><span class="pre">QuerySet</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></a><ul>
<li><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#when-querysets-are-not-cached"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当</font></font><code class="docutils literal notranslate"><span class="pre">QuerySet</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s没有缓存时</font></font></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#complex-lookups-with-q-objects"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用</font></font><code class="docutils literal notranslate"><span class="pre">Q</span></code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">对象进行</font><font style="vertical-align: inherit;">复杂查找</font></font></a></li>
<li><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#comparing-objects"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">比较对象</font></font></a></li>
<li><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#deleting-objects"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">删除对象</font></font></a></li>
<li><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#copying-model-instances"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">复制模型实例</font></font></a></li>
<li><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#updating-multiple-objects-at-once"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一次更新多个对象</font></font></a></li>
<li><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#related-objects"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">相关对象</font></font></a><ul>
<li><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#one-to-many-relationships"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一对多的关系</font></font></a><ul>
<li><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#forward"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">向前</font></font></a></li>
<li><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#following-relationships-backward"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以下关系“落后”</font></font></a></li>
<li><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#using-a-custom-reverse-manager"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用自定义反向管理器</font></font></a></li>
<li><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#additional-methods-to-handle-related-objects"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">处理相关对象的其他方法</font></font></a></li>
</ul>
</li>
<li><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#many-to-many-relationships"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">多对多的关系</font></font></a></li>
<li><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#one-to-one-relationships"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一对一的关系</font></font></a></li>
<li><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#how-are-the-backward-relationships-possible"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">落后关系如何可能？</font></font></a></li>
<li><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#queries-over-related-objects"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查询相关对象</font></font></a></li>
</ul>
</li>
<li><a class="reference internal" href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/queries/#falling-back-to-raw-sql"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">回归原始SQL</font></font></a></li>
</ul>
</li>
</ul>

    
  

  
  <h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">浏览</font></font></h2>
  <ul>
    
    
    <li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上一个：</font></font><a href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/models/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">模型</font></font></a></li>
    
    
    <li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">下一个：</font></font><a href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/aggregation/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">聚合</font></font></a></li>
    
    <li><a href="https://docs.djangoproject.com/zh-hans/2.2/contents/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">目录</font></font></a></li>
    
    <li><a href="https://docs.djangoproject.com/zh-hans/2.2/genindex/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">总目录</font></font></a></li>
    
    <li><a href="https://docs.djangoproject.com/zh-hans/2.2/py-modindex/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Python模块索引</font></font></a></li>
    
    
  </ul>
  

  
  <h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当前位置</font></font></h2>
  <ul>
    <li>
      <a href="https://docs.djangoproject.com/zh-hans/2.2/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Django 2.2文档</font></font></a>
      
      <ul><li><a href="https://docs.djangoproject.com/zh-hans/2.2/topics/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用Django</font></font></a>
      
      <ul><li><a href="https://docs.djangoproject.com/zh-hans/2.2/topics/db/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">模型和数据库</font></font></a>
      
      <ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">进行查询</font></font></li></ul>
      </li></ul></li></ul>
    </li>
  </ul>
  

  
  <h2 id="getting-help-sidebar"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">获取帮助</font></font></h2>
  <dl class="list-links">
    <dt><a href="https://docs.djangoproject.com/zh-hans/2.2/faq/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">常问问题</font></font></a></dt>
    <dd><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">尝试查看常见问题 - 它包括了很多常见问题的答案</font></font></dd>

    <dt><a href="https://docs.djangoproject.com/en/stable/genindex/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">索引</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><a href="https://docs.djangoproject.com/en/stable/py-modindex/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">模块索引</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，或</font></font><a href="https://docs.djangoproject.com/en/stable/contents/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">目录</font></font></a></dt>
    <dd><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查找特定信息时比较容易</font></font></dd>

    <dt><a href="https://groups.google.com/group/django-users/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">django-users邮件列表</font></font></a></dt>
    <dd><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在django-users邮件列表存档中搜索信息，或者发布一个问题。</font></font></dd>

    <dt><a href="irc://irc.freenode.net/django"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#django IRC频道</font></font></a></dt>
    <dd><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在#django IRC频道上提问，或者搜索IRC历史找到相似的问题与解答。</font></font></dd>

    <dt><a href="https://code.djangoproject.com/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">票务跟踪器</font></font></a></dt>
    <dd><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在我们的`ticket tracker`_中报告Django或Django文档的Bug。</font></font></dd>
  </dl>
  

  
  <h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">下载：</font></font></h2>
  <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    离线（Django 2.2）：
     </font></font><a href="https://media.djangoproject.com/docs/django-docs-2.2-zh-hans.zip"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTML</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> |
    </font></font><a href="https://media.readthedocs.org/pdf/django/2.2.x/django.pdf"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PDF</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> |
    </font></font><a href="https://media.readthedocs.org/epub/django/2.2.x/django.epub"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ePub </font></font></a>
    <br>
    <span class="quiet"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
      由</font></font><a href="https://readthedocs.org/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">阅读文档</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">提供。
    </font></font></span>
  </p>
  
</div>

      

    </div>

     
     

    
    
    

    
      
<div role="contentinfo">
  <div class="subfooter">
    <div class="container">
      <h1 class="visuallyhidden"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Django链接</font></font></h1>

      <div class="col learn">
        <h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">学到更多</font></font></h2>
        <ul>
          <li><a href="https://www.djangoproject.com/start/overview/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">关于Django</font></font></a></li>
          
          <li><a href="https://www.djangoproject.com/start/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Django入门</font></font></a></li>
          <li><a href="https://docs.djangoproject.com/en/dev/internals/organization/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">团队组织</font></font></a></li>
          <li><a href="https://www.djangoproject.com/foundation/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Django软件基金会</font></font></a></li>
          <li><a href="https://www.djangoproject.com/conduct/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">行为守则</font></font></a></li>
          <li><a href="https://www.djangoproject.com/diversity/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">多元化声明</font></font></a></li>
        </ul>
      </div>

      <div class="col involved">
        <h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">参与其中</font></font></h2>
        <ul>
          <li><a href="https://www.djangoproject.com/community/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">加入一个小组</font></font></a></li>
          <li><a href="https://docs.djangoproject.com/en/dev/internals/contributing/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">贡献Django</font></font></a></li>
          <li><a href="https://docs.djangoproject.com/en/dev/internals/contributing/bugs-and-features/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">提交一个Bug</font></font></a></li>
          <li><a href="https://docs.djangoproject.com/en/dev/internals/security/#reporting-security-issues"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">报告安全问题</font></font></a></li>
        </ul>
      </div>

      <div class="col follow last-child">
        <h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">跟着我们</font></font></h2>
        <ul>
          <li><a href="https://github.com/django"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHub上</font></font></a></li>
          <li><a href="https://twitter.com/djangoproject"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">推特</font></font></a></li>
          <li><a href="https://www.djangoproject.com/rss/weblog/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">新闻RSS</font></font></a></li>
          <li><a href="https://groups.google.com/forum/#!forum/django-users"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Django用户邮件列表</font></font></a></li>
        </ul>
      </div>

    </div>
  </div>

  <div class="footer">
    <div class="container">
      <div class="footer-logo">
        <a class="logo" href="https://www.djangoproject.com/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Django的</font></font></a>
      </div>
      <ul class="thanks">
        <li>
          <span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">由</font></font></span> <font style="vertical-align: inherit;"><a class="rackspace" href="https://www.rackspace.com/"><font style="vertical-align: inherit;">Rackspace </font></a><span><font style="vertical-align: inherit;">托管</font></span></font><a class="rackspace" href="https://www.rackspace.com/"><font style="vertical-align: inherit;"></font></a>
        </li>
        <li class="design"><span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">由</font></font></span> <a class="threespot" href="https://www.threespot.com/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Threespot </font></font></a> <font style="vertical-align: inherit;"><span><font style="vertical-align: inherit;">设计</font></span></font><span class="ampersand"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">＆</font></font></span> <a class="andrevv" href="http://andrevv.com/"></a></li>
      </ul>
      <p class="copyright"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">©2005-2019
         </font></font><a href="https://www.djangoproject.com/foundation/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Django Software Foundation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和个人贡献者。</font><font style="vertical-align: inherit;">Django是</font><font style="vertical-align: inherit;">Django Software Foundation </font><font style="vertical-align: inherit;">的
         </font></font><a href="https://www.djangoproject.com/trademarks/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注册商标</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
      </font></font></p>
    </div>
  </div>

</div>

    

    
    <script>
    function extless(input) {
        return input.replace(/(.*)\.[^.]+$/, '$1');
    }
    var require = {
        shim: {
            'jquery': [],
            'jquery.inview': ["jquery"],
            'jquery.payment': ["jquery"],
            'jquery.flot': ["jquery"],
            'jquery.unveil': ["jquery"],
            'stripe': {
              exports: 'Stripe'
            }
        },
        paths: {
            "jquery": extless("https://static.djangoproject.com/js/lib/jquery/dist/jquery.min.87e69028f78d.js"),
            "jquery.inview": extless("https://static.djangoproject.com/js/lib/jquery.inview/jquery.inview.min.4edba1c65592.js"),
            "jquery.payment": extless("https://static.djangoproject.com/js/lib/jquery.payment/lib/jquery.payment.e99c05ca79ae.js"),
            "jquery.unveil": extless("https://static.djangoproject.com/js/lib/unveil/jquery.unveil.min.ac79eb277093.js"),
            "jquery.flot": extless("https://static.djangoproject.com/js/lib/jquery-flot/jquery.flot.min.9964206e9d7f.js"),
            "clipboard": extless("https://static.djangoproject.com/js/lib/clipboard/dist/clipboard.min.bd70fd596a23.js"),
            "mod/floating-warning": extless("https://static.djangoproject.com/js/mod/floating-warning.a21b2abd2884.js"),
            "mod/list-collapsing": extless("https://static.djangoproject.com/js/mod/list-collapsing.c1a08d3ef9e9.js"),
            "mod/list-feature": extless("https://static.djangoproject.com/js/mod/list-feature.73529480f25b.js"),
            "mod/mobile-menu": extless("https://static.djangoproject.com/js/mod/mobile-menu.841726ee903a.js"),
            "mod/version-switcher": extless("https://static.djangoproject.com/js/mod/version-switcher.c28bb83972bb.js"),
            "mod/search-key": extless("https://static.djangoproject.com/js/mod/search-key.f3c0a6fcfedd.js"),
            "mod/stripe-custom-checkout": extless("https://static.djangoproject.com/js/mod/stripe-custom-checkout.aac1352045b7.js"),
            "mod/stripe-change-card": extless("https://static.djangoproject.com/js/mod/stripe-change-card.682c710317a8.js"),
            "mod/console-tabs": extless("https://static.djangoproject.com/js/mod/console-tabs.70ce882faaf3.js"),
            "stripe-checkout": "https://checkout.stripe.com/checkout",
            "stripe": "https://js.stripe.com/v2/?"  // ? needed due to require.js
        }
    };
    </script>
    <script data-main="https://static.djangoproject.com/js/main.07884ebc4865.js" src="./12进行查询_files/require.177879fbe7dd.js"></script><div id="goog-gt-tt" class="skiptranslate" dir="ltr"><div style="padding: 8px;"><div><div class="logo"><img src="./12进行查询_files/translate_24dp.png" width="20" height="20" alt="Google 翻译"></div></div></div><div class="top" style="padding: 8px; float: left; width: 100%;"><h1 class="title gray">原文</h1></div><div class="middle" style="padding: 8px;"><div class="original-text"></div></div><div class="bottom" style="padding: 8px;"><div class="activity-links"><span class="activity-link">提供更好的翻译建议</span><span class="activity-link"></span></div><div class="started-activity-container"><hr style="color: #CCC; background-color: #CCC; height: 1px; border: none;"><div class="activity-root"></div></div></div><div class="status-message" style="display: none;"></div></div>
    



  

<div class="goog-te-spinner-pos"><div class="goog-te-spinner-animation"><svg xmlns="http://www.w3.org/2000/svg" class="goog-te-spinner" width="96px" height="96px" viewBox="0 0 66 66"><circle class="goog-te-spinner-path" fill="none" stroke-width="6" stroke-linecap="round" cx="33" cy="33" r="30"></circle></svg></div></div></body></html>